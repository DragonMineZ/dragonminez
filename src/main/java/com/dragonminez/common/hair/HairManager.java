package com.dragonminez.common.hair;

import com.dragonminez.Env;
import com.dragonminez.LogUtil;
import com.dragonminez.common.config.ConfigManager;
import com.dragonminez.common.config.RaceCharacterConfig;
import com.dragonminez.common.stats.Character;
import net.minecraft.nbt.CompoundTag;
import net.minecraft.nbt.NbtIo;

import java.io.ByteArrayInputStream;
import java.io.ByteArrayOutputStream;
import java.io.DataInputStream;
import java.io.DataOutputStream;
import java.math.BigInteger;
import java.util.HashMap;
import java.util.Map;
import java.util.zip.Deflater;
import java.util.zip.DeflaterOutputStream;
import java.util.zip.GZIPInputStream;
import java.util.zip.Inflater;
import java.util.zip.InflaterInputStream;

public class HairManager {
    private static final String[] DEFAULT_HAIR_RACES = {"human", "saiyan"};
    private static final Map<Integer, String> PRESET_CODES = new HashMap<>();
	private static final Map<Integer, CustomHair> PRESET_CACHE = new HashMap<>();
	private static final Map<Integer, CustomHair[]> PRESET_FULL_CACHE = new HashMap<>();

	private static final String CODE_PREFIX_V1 = "DMZ_HAIR:";
	private static final String CODE_PREFIX_V2 = "DMZHair_v2:";
	private static final String CODE_PREFIX_V3 = "DMZHair_v3:";
	private static final String CODE_PREFIX_V4 = "DMZ4:";

	private static final String CODE_PREFIX_FULL = "DMZHairFull_v3:";
	private static final String CODE_PREFIX_FULL_V4 = "DMZF4:";
	private static final String FULL_SET_SEPARATOR = "\\|";
	private static final String FULL_SET_JOINER = "|";

    static {
        initializeDefaultPresets();
    }

    private static void initializeDefaultPresets() {
		// Goku
		registerPreset(1, "DMZF4:DtWmuQFNUV7tldeSwEgYABQxBR4gt57G4QrMj09JZCxMKK4iNYGMnIImQR3EXtboPBJJgihYYor11YWCRKFnkoINEg7swAirAQeQQQgppImYQyCWpZGhND7txzzr2nb3fPLqlKJT_yw3Lcuec75557Xt8ZSy2r1Eo4HcU_pZZldTnHKqpxKyssS3yo9ZIZK5H_4Cdnyw9pPye-KrYSU8TZu8W_q638fxpCdXX1XKjGT_VTQpPaLJTVQlVxQiHzHG3e5GghdpXO6uw9cQqqqqpirZrSZiF2_6mtWeVoq77Lz9a6yZaWfaBgXsteJYRnq_FsUSzuZvmXGt-ZoRRMa9VFJJTTQveehVXTuVXiLL5X5NkZBm6hs_epsyJwb8oHbkc4-0zV5Ly9XqpRGp72s6dDN0gMNKzC0KNwiha6MiCkNWULaRrE75R283EgpUeeOfM5SJ9G6dw8kt6lpAcH3tRL0Vm8XI18Hjw7xDAP7hR9dqhxFhzMjIkSKjOc1rtuCUhvKq_g5gkhFe2JchRKoFB5eVlQKBshVKGExOOOyz9uV1JZH3SjWTTSfiZDeI0Kb34wyjERxIPRLXV6Jn4WTCPl8qyGe6LAESgRp9XZJ-OcpgwHR3DDdfQsCBqOr8IeN9svrHKhkUZwlkuDSqEb6hSDYY-wqFXdEdddbOgucN3G8DstCUgXvmUdni2JPatx6-PORtxgaeQN0m62n3n_qBssCzot26YHa2i7kNa0vFWhiMutUELiwwP5sBQJdl0-wUrkJakGufkaFKxTmHLMGGe0xFXRzcU3x4iLAMBw9FPKLFnUeZJAZS1oTlbhYRlm17SKDDwM87bhweFAwytWeB2soslpq_1FQ64dOmToUOG8G6j1sAjRlz4d6sFU5B1V5K1dQSdiQVQvWeM55PqU4fq89OtxZT_i7O6gJjri5Qop2GOYh2EVZZX2WEug7fkpO3xkr9EZG-ON0UL74uoLthPf0YPWr43WE-pXqvUwoTeUUAcrca_VrvL-2pnTp-Un5JtpQu76PzQhb5lb8l-ZkIU7F_c_DgFR-skiQ-UPzr8vaOf2iuiZWcA0DHDg_WdeuFrC2D8edh5OJcufke-U6W__IWhWctHXe0ngzEcTx0fN1QJvSZ-jUBmXPlxmjAiVYy-Q0snbb51bcNIWMFsuPREeQiWMvXVPXwnTrGGqg8lif7_qMjBCPBTA3D_oHQjzrUs7AV7T5d2gsBbPXAiVp9v4i6Pmc2HWpvXXgVljn1gJbbnH1ocB-IeEF7qmLfxXcHQXeMl5KwCvqXhp5H2FrzVM9FQv7tvQ3BtgPru4S3C0zPvaiPhJxz80Jn_CO_LyRjBr1LmNgPfYp7uDeJltY14M4uUDx2AHhLfwqZTEGznjrq_CCChcDHiPX2BLb9FX_Jo1wUHPGSBhhNA3-9Wa4VerzhIh6Qzp0fL870C6dPEMThzSXmp4xwYopas-WBAMqdyIU3cW5Co1bjM6VJEWr7li9Fe4b9KyjBshpWhMwqAxNmSZqLu9P6-D6iIyx6AxRufQRuhG-r7MWsZn8rEQzWcykOqMbmT12Vb5TF7TWfMZXTHPhs-UX9J01nwm-3bva0J8BucRWVPSbvLAuP4Q3qo8PDR0lIRpVumCh_3srtN3mc_yNXPQQWAbU9-1MUu85PKnfwtBgjq9XPGhraCh-oprIVq6_eQqI5MSww3TJ8hyLSyGZxbAq5sehItjivrJ26Az-KTKz4nQR7wRcdRudt0Rg9oN6_lUsKClHnnyN0blCFI7Ib30rW8FOJ5OilyDrLwiySbK3Bdt_6dNDxZkfcKI9CVNwWk6n1sFeaAQGos1RY_gs2snxhDCuQ01IFRz5Vq47mfX_wik50uXCDt18sYSwp__ohKuC51RSK-aON6Ubp0ZQlOPYoYsi2OZIVxBPBT2cp5tJjNc9-xbRrtfJV0tdL8sKyYjWLokGxTRTb4x4nmjQSwA3R51Rj-5Ec2yP3n3UjBLx0-QRhKeCCSszW5GZRB17uz1-_sZ19QZWW_gwbuIa34kn0Ndkxc_6vu6T4dYKEQJZ6H1ssGKB1pz8g4wQty3NRaKUeJnsE_7tmpg8SwUElzYSfHIUiCWha5c3RWE1su6E_D5_1nof4SFdo5hoRkMPTa50vOz-aXtLJS6Fp9741ho9lDF7-GZevU5etYsNKVaqMlCcbBJezReMTp6att7RmybdDQ75NFl5mQcR0fzcQtCq2VtDAi1Rke91OBXb4S4EB-ieKmoXMhPPExy1fvF_VVdsQ4YwTRFkgZeVx5dNhJU7pddUjz3eFkihO_7vv0Ywhw0YMb07WyM_WvWPAsw2OB9OuM7qotbh42pAOdhNuOOBvbFrMHJwXfUaGsdiSXb4zjZrnXtnn8dGCQYlV0fgR8d7O5__hvvfIxp0FdytjcIOdZnu8OUHfDe3f3FANyhSzUAdwQXa_ppn3PPfJM3TjLw2uEElsJocZ2TcroSeO3-dDnAwIdA_lQZMOe-vzPIiivbTWgGmG7Tvg0wXaqvUDzP4PME0x06n6aLlb0-Hsxh0p69W3YzEejUL0m5n6F-aauCr7YApKHjqTuDWwCC8ez2OBhioxPA4OzIdQDhoVns4iXrugMe3Je_B3lArQMYBZwa9zC0F3Deef0UPgxQfHqYwgsCwus09VPAm3veYTC0e9lDgFcqU0jgtcfOWWhTQHidYQjXK4PKon9MwkCUPmYrA4ragisDAkYjWAz0hJSki7PRPeyBiN0BAUM2sN2BzskSnEaTNHzb6s2KcaBOYcCwwUCtFUhDAoYINzXpy08bGoomT4D6AsOYALbe2w6mv3nkIqieejk2Iy7rt-EUqtOLfKIIGP0lar9AeHhfvV-oLLvxZsADs0T9-2fLTa0uGkJvdqvkQAJvkCxlAg-9rnmcrdILrfDppf38uxrriRK1nvgClO7XYAp1iSe5zt-BF3r0lchk-UHtKcRldsi2LlShA6MWFjQCZ8vXB1_Rqds7J2ZzkYV-KTRslURYaLhMdiZxGdFJjBUGaXhxyBdBA06orvPBc-tAw0vyg4gTbHB-8jlZT_iaQ3xlrDkI-AWgjG6W4sQZh_WTSIX3Cj6nt10tT4lvZAY450Mk7uhSbWxASMMrsmgI01esOAYaTuFLowdY_Uxu2eAF57eIdQkBI4lijHg98GkPdXJnowN9uoyf5zjGboWAd77wPQCec8stAPxAbjMAQ1SIkFS7ueZNPWAVgA_MaUCZAbyRmtVGyG3XmSeF2Dill4gbBrpGiKvVTMgDE5asCrYSCi6P9iS0tRHAEDAiPHD1yNdMFXFxB0tioSFBZJHiTu9xyMdqfI7Y4xAwppdLmcf2OOhRL4N9wsvNmjMFNGAs-dmdwFT9nGhxqGGYoQE9wJxDkwH5LWpTRM4h5VGbohCTVpH9F6yJRNo92or7yd1XfSO4MmLOGcFLF18ZrcWWqbaReikVWoaryI7YHZHFwMxFKaS1nHOs_bDgeiVpbJOEhlW0IaKAiVgrkYaV1NDU-l7N3bD_Eni0kFYpE7FxMuNEF74RclZQxZtFBQ0WUcsowtu1ZQPgLbjjdsAbePfHgAdf8bUKFgJd5hwRJ8aeioD3_2pMHDDGiYd9WwDve-lLkCnkgZS2eKEBvHf4LACuhh-LmAf2_PJd45cCZfHanX0AWO9MFsUlyLyjtwFwLzk4qvqpEoQ1K8pXNuipxVfIYtVTlCvw4h7Vd_bLF0r5xHL8lC58S1rbYTlzoERQVES94r-1HNMVGuxTyzFmsZp3CmzJFHBWjv8CeCwO0wpYd8GQKyL2ZiXm72VEJ5zvSJ6X7ynyq_z_kQJnWI8Kb9JCj_ehfBiBN2r6q_zxmH2Flmyh9o8bCddZJDmNKsNsHZqMKAjLDbzc5tFGc1ZPDw_NXlw3ovBqriRyNScUYKF2acvCXgoqRHWt_vVFxcIxeZj_jyywDuGmw7ZCzFrHIW_d7cRT8AcFUXTnUKsr7zHdXKuY6zvlCjV2lsOCmf1kobIAZy0_peYetb4j-_AOrNaquQd6Mh-ooN4FJvBihRe_vmNNyP7jiQGgpnH-1aAGJgi-0FMDIdE19pvqrrgcw42s68yi0Dgk3cCoRPLg1Sdb3fURMNRZNgURTaASLGo7EGABjH_xsxfOrjfqmFoMEjBRE0XZKztRsmHj8-zHZdap5aHQgHRD_3wSsUUMzbLIBdh8r8gP1WJHaXiNFvf0E0vEppE0oCPdFP56x_oT1AmBh11XDz8Ra8lQAWoMzTzUoXFjyQwttLoMGUqVQ8-yFB4pFd5YlKO2miXmT_jI31znDP3Q8-Y1NxizMRwOOPKAgacKj0rnE5IJq4unPYoptnSEIhDYpB6Mm6FU-O6UL874jN6FYv_khh428KAP8GDFv3gpNe7iX_h7HGHlge1CrX8B");
    	// Vegeta
		registerPreset(2, "DMZF4:DtWWlsFVUUnulDwQYJICAoIiJbFKSsUiP0vUE2IRiwEYPRQMpipdDaSp03KKKmKhHEspVSWmRrKTtSQGRpX1nFFEQUkEVQECMiBpS4hB_emXPunTPndSqEH9akTZq-vDnfd8-99yzfmcZqWqymG3eI31hN0-repsWkm8Edgz4RHzLCCSPbZtrfWKGpGaMCmp4sTF4Uf1PE3xgNbFsFfwTbD-4Pgm2jbVPQNtlrG-q09ymwXVxU37Ete7dHE7R9ifH-NmoE2I5oXc-xjYw5eRVtxzPe3fVSwDbxgSLw4cnDLdE2hdlunlYLbLNbZtjfhBOefWaaA7K3jaAJlYKEv8IrNJno50PHhrXBX7FbtE312hqBr7aB7RB5Zq5tGrONzUlz3CxVbooTR9uXqW2S2TttZFsANRjRGhaYXlBoP7LkI6vMRaezldosCQFoKJwM3W2GshWhMswOlTq2rZkgPjlrlw_QgKZc0bzfwg6nDAudSLd2ddM04NM70bUFTcrDfeEYxSUDetbiOwGNj6yIikE9jp29Am1eF3YOC53wgDqzAFNBvnLlKgBllpcA6FJBIYK6MD-T2hXDkiLAAD0HQi4cKQ7kgcOpHUygOdOsF9J0YzRj259m0Ti5c396zYIGbaxycZlI092PJm9KF6ApWH4K9oIhRo7P3VRPpNGR5vk2BtBcci5K0BQVvwqbmvHnAaAZ3uokeCPiEWniFY2IiUQ7JuoD3_ylkxhfoeOooMHzI8msf8g2tQDy3Qwdnv21Dzqoyoae7YdWJ6vQyQ81gLBWea7PYmjluUIXOyByHW5p0Wf7lQAsb2GjafPjrLToc_yWVNvd16OJg7Z3CWvLEugmpD73X0_twKMDgQYD3ZL3TL2Zx2pAizMz6L7TwyEIa1rO9By29qRHzsLafztOCPSx7R_DklO6TAa0OFBEz2forevXsOM7XdqMHoBAq5ai5zL0TliAoL_pNZgHyQJ2USIxwfbIY-fhUkUCoW0esxUFBGyXQvCFI1BtPLexkIGwFrhpHYHWRzuens9A6uZEFUOTAmaiqg422zC6R7uuvkiBxIdM-4PIz352ftbyq9kbMq_DfcEjkeZrGy9hJ42PTLuKgxPpHVfTDkrhHUZfw86hs2ITTWPG3eVFG13bFSM6plI0db0EaAhabAbRAbWFOlrMuCSt9oNxzo84j8FV9jDeP8M7sX-SvUJ7I63VbW_afj_hI7sFhqBHdFT4gdZBQwkbidc6cdBBvwiZuegEtz3EbFXXmJaf7tUYbj5oX7IwwCpKBNo7C3vDnjCA3XoVUh1QO8JoBrWoy1JFtmHZNSxpYxmq52hHWTygVJEySdBgOSHeyLIXUh1QO6Zo6mj6RO32PpMyXkmdYEvhp2uk8H8shUVAVD8p7OrI6iCFbXV381JYXMtNS2EbXSOFfaSw602NFK6RwjVSuEYK10jhW5DCRFHcuBQOibJ8o1I4pDrg_1cKq358S1LYUK2rCimcKKUw9rJTvd-ABYqGXabVSfDiI3obo5G3Frr3-4D7AF0ig_1Kv58A_fMTb3GpOoahsQ6ahkhGtvaJHRe4nBvL0Nf2bwE0JjdZ-9Ke5qwTauMYunRjI_T8-HBAwzcCjY8qGwokGluYaey8Poaht2_4zm9MkGjsXKZx6Fx7QO_u9j2gy0sG-A0OEo0mprEHDisse0RYziquExH38Mczmo9g9DGN846AEjR5y1YAGls2Ve1yygggGtSrQF_85S9aSaILiCd-JjCaZSv6AM3Zzy5SgUecICJ9IkNLaeFuAWYegc6WEl_1ZTWkBFAKXHESye1hVb2vP1G7x80PKUecDBALgH64gSFF7Cnr3uXsYKfmHquOL-5duRRHI6vqacVVSZ29t1HJtCJaLIBEoWPTigyAQpwPjJmOnldimIpCDDEroqJQTStRtQDkrKCJdF3LphVZFAhNd-ZN9NCjppU02cTl8bkRoKaVqNQ6CqmgWl04glrNUu8iCE08jQk6reCsYxr9U_d6D6lM1Qv5vsJNVTW2SLdQMJsG3AsdPCQ66ArGbIZejRHlHnEUmsjNWQy9DTLURIGguqBAbwJtTv8nNJuhv4jfwNBydJAKwZIFvbJBJqrmP7flnN8gg3FDyoMaZCTN5w6aXkf0ILNn02tcTM9jNGcSNjqZHmxj3AN8yc5cIPjgEXULja3SbtCvKXGOX1ud7tgKvl9B2pP2crnvJi7K5zOaPwYOBZr3LuwCmqv73mZRJ9s0iZtcL02wqaOdCU2wCRYVRRNsjCFgJysbiKQ3P8hDyspKBm_ORd6kZ-M5kjyGPvzpIEDnVmQB-uDWu8EJdcR4rXQvCxkNDI2UBolJmano-Tqf4fMZDfZ2UvSgzgr0xrX9-NuHAoZGzwla7sV1Qu6F5NQiReMzc4GGTzIT5j3eFBaIv_iCV96XoaK2ZDWQCou2HiVL1Igii6grLKQ0ICJJZzT5Ua98lLpZIN-3utooptJ3FmIzmC9k8odHgmZuVE-rJuOYWAF9I62YzWVEIZFRqILFyppV38JdDHEEJrlKO_HZVbri6aC3tbtvGKr474Ws1RjBpJphgSfhuX5NQ78hLsCvX01fcP10bMrBN36VDHEBfgBKRUUPcfjahM6hRxlNthzilN7HHh8OqpTAb0j9UENcjHeI0_4B");
		// Trunks
		registerPreset(3, "DMZF4:K1aC3AV1RnePCQkpAhRbGgRI4pVDJBXkTjVu3czSlqYOGp8FAerjQSDwaQJ4u5SLJ0OduigpfLKgxAUlUZ5KCBiIyZ3QyiPJBSwgCBqi6NtxrZoh9G-e-75___s2XPv5ib3wgzDzt1zvv8___lf379kaFqGlmSks78ZmqYNv0RLrjcDOwuL2EOdWTJJ08IPVvA8f6i3A7N6esK_2MEcTUvRkqrYpkfYv9Xs32Qt6u56K7CipxdgNg4AM3fQMKEImJALUzkwDNt9foDd8_x2F5ESuGlgkzwaE6aysjK2SaoGDTOgSeYP-lAD2uYxAcPc5S7hLnagsbGJr-0Sa5NyPSKjLpkce8mU2EumepbQSeS1k8TavCGszR_C2oIhrC2UjVgeNuIouBRYy3bjA-2usI0c8Fy7JFPArFSuVOwe29ig7C7F3WGHxd2_wt0pkbsV2Q7tDrm7n_PbHaG5Q5p3uZqv8tN8UOde7X_uptjnXpPQudcmdO51CZ27IaH7bvQ_d0PsczcldO7mhM69PqFztyR03xsSOner0Jw9LAo_sIC_PRzwqeE9plMLe0znfcrC4kyQoCt48uW44cMplni5ct7AOPJ2N4knRTXogDDBnAjbaMkyjM_uJu9hBIxTKmBSBMxwLXlehZZ2TR7_w0w1y1NgmsEx3HMc8CkN0pKDsZccir3kcKzkXiKSu9YzhLW9Q1jbN4S1RySTJj2uDSt5on5hzYJwl3c3dXmjlDYgvWMs9CJHV_1e6UV2L0-N1eUNH1l9Mbq85H_PvRhdXtLMPQl0eeIsiXV5I2r2X4wuD-4l4S7vsnPXx9XlAUxPTx8P8eDu68_KF8R2L9WSeGTr7YfHc5iO--9djjDV3gSh_6TyBq5NiHkUwDwx5SOujdPePALw2iaNhryVsnANZIrRs69FvAVKMt657XZQq-y55zlw8PL2pwD4Z4RH-nWWlF3F8fQJ-qeI97iCJ44ZWNEKeG0pzVHPW2d3ujA1irU6QaSpt0BMmcF_XjvS69cBZiQvXnDumS8Qr1bBO_n2DlBrxqUbAe-Zrw558Tr3cpeX8PSfT7sC8X6k4K15Icjxbq196DqOZzATA96zV-ncWvRKPmadDMM2TeQwbNOdOfWw9u8Pz8a19RE0IdObrJyygsUxaIKzyNkVgyY4D7x5LgZNcPStWYOlCdLamDTBKe5_cLA0wWGmikYTmBHR7924NAq_1absPphTH0Ec4CYLCwtgN8Y5RTUL5g_H3oKbinBTEm6q5DFcYQaOlU8AdxLhuDh_BofpEO6Ji-3QgfMPAXDzUwUI_G1FGwLWMdRMHb3SCmx46f3wK6sDZVpOyrvtIKH6xtugdxv9i5sUz02arqg-Z6IBGn-24WUA3tz2JBwcQ8IO3DfhDMcjUbaTsa4W8YoF3uCJ13UFi6F_cmHiIF4BkRXjIV5uFMZDvNwMGg_xMmbU7I-feHW6lxkP8Vpa_3D8xEsK0TiIl5E97lT8xCs0df8d8RMvyVviIF5Sbm1O6NxxEC-DxXX8xMspvzA1fuIlVYO4iRdLwM6cDj8GtqL0yqEyMNb3sVR88agYS3XQTcicTCT7QXMyloE_5U1OVHK2ZFnVIMlZppecGaLS-ZIzN5_4kjNDBK4vOZNQYpIzI_eRC4MlZ9IBYpIzSc2-Iaw94m0BgqygwqblLXVy9WU9oai12jHFT6p4m8xKLOu5YPfT629VCNxs7idM9vgPn0GY4wrMzPGZSqP7yiuvAgyWWJvWSAVQO6HUZewAzfASgCkdd0rRBmu3bImTAkalqeVemqqP-Vuut6UuGfXTPi5Jz_rLP6C1WPudbG9vTa94N6sw2FTQXB9etQ966yx7nZf-6elgYitcfAHvkkdXKulZUFnCG4Y9UHAzb0OYST7m_Q3DG_bnSQADDx6mVKnAXPpZN8AsvHozqDUMspKlj17wA4AZWX2jYDYKpyWYrMlbvASpJPvCVBmmwtIPHc2BtILcySbhdueXnDSyjoz1cQrdJQnp_Q9yCaGML9cCtyMKpqdhaxZuAQAYjF1ndxVF8F7CQ7Wkg6duzQI8OK98H2SBAF69THrm-11MA3imaXx0sB8vBkgtXYzEFaWLfkzBGzH_K8BbfsUJUDSLN4oML4OHEMMDCwzMjQkvE9pglySLYQjaWCLJ5LUDkmQCRiUkHxgDIUkHl5rnSAtEYcsEDNEgsWU3JlN_XcKdK1BUeiWXoIs7S-H0hhUbdBg75BLfGkVC0uZRIGHuN19SJCTPmwP55XvcfRmw9kkXqP7eyWvUuVWtX9TvffUDJbzIJoIC0S_RGDXh4XldRl1ScMfdgAdqsfz33567YlLriDu7d8wLgDeFpzKGh1Z3mZQuwgu1sOmm7fC9KoQ8VRDyr0Hq_i3fXWF24FWZxr-AmVn0ikUyf2Ct0abPV8Nh9hX9EUShAeVeO9d7mECocJv3Fo3G3mUgASclFgm3wm0zSGjnVJRJuCEFWosQqyTKOIAk7Mm7DCSsbDwJEj5_bStIeIs_MD_BAmcHXuP5hAGP_U8jALNXyhCBgN_g4ymW3chPjHLMn4EdkFqtd_A6ra4iGqjhK7tzovEN8MR9I6uVGQRJeIcnDaZ6a-tpkNCPN40WkPJnYPd2C_IJVkE73AoqAwsCfvv1PwBw8wffB-Bt3JcYMMiUjY0GtOkwdoiFlTLdIODuN34MwMvuuQeAFzm7ABi8grmkmEZ17LwcyDhesBTtYhRCwDuoWO2A2DbD7bZ3vOGOzbbnmoqLi-FIhAXmNGzylhJyLosmFdI0FByGuQcO2-wQa4SUSUqE38FYVEyeJb9zJylkYxq7RJukEDCGl0mRJ01S0KJWJ9YJK9ysgwT0JTvUDVNV22ElDiVMUySgBSTjUGdAdos2qyHjkPBosxqS8Lvi1xXP_ivmRHzFrI6DJztw6Kbveoc2knGK5dQlD222YMkk3iKNhSLGv8Kz3TmrGOOQxpugNJmkhGmcTpsGeC-qBc1p4TZmEnCXHSKHMX7Z9qQy6iEJz1NBEwNr0Xcv5amL4dEIVoRMp-i-xPBH9RM38RXzXkEkb8krqLGQhyqrFLwDu7cD3uoH7gc8Rp0AD16xREptIiUCN81J3H-1Anz0NzP9gNFPLKzbDLjvra9DpJAFgq7GaxTg3ulLALiaX71sgcNvnlNm40LjLd3jAJgdRpkvRQTIilP3AXA2bxxF_hQBIhUrilep0ROjpwiNRU0RpsCDW5Tf3VaXdtnEcuygm_ga_CJvenoLSFgGKYK8Itot6tTsSxm6MSawyNCgHwtp6seExqLfkUK6yQ84xNt_BlyGzbQAdqtghCncHlXMu1LVL0REJ4wfcp4Xrin8VXj8AWukGuV6xXq_y_uCXwzDm0Gf-eDyJP06qUrr4ruImIlFlP-8p9cD3lrOaUQaZniYj91wkBLCBgXP2VWqFGdx9XDR0o27hci98VaBF21uxgRgojaD_Xs_8d6Uns0LXHW9-_FW-MJpvliagOF4VFZd02BkFToDcWs6R-ibJYwXKiwKcstBoXZgGm9qpIokDTvU2RpJEJTN2MP9jkkog6RrURKXqurkrDQvJXIuZKVFm7YxCXhOKR-L3ojyp9t0QU70dOkpwiZi2nZbfl5-vmfa5hYq_U9nJ4KYjStvBjHQZbBwwbmQ1DSS_tKXxgN-cbiNf69hwEvIfd7lCUOiG4HjN3_s9SOJ3R5UgCEXS50SUQlK0yz_A0lmwPiLHbp6aZOS68Q8kICJvgha7353x-Jo6c_yyGR3mkNNHlISO4T3ZAfdCephv34X-YLEAQRBonxtCAn4yg5u4vcgJwExhCQJaEgziN_YpBoGuYThYWV2GySJmPf6JamNEX2R8ELmA15FQziwkoH7_BSl7OL2u-QeQeHemLilLyFi8pmqfthGjmca_wPnsgLv3TJL6Z9hsceQxxQ8kZwE0zzL2bI4OAtw9ClpMAk50zNtPe7XZwn37ab_lkGcx52XYo2VFT2h4EGtkJ0Vf7GCoiXGX-T7OCmlB2leqv0f");
		// Gohan
		registerPreset(4, "DMZF4:DtWXtwVOUVv5vEEMI7ggVL5SEIKo-8xOCU7t27RWhhYArxUTpY7BogGgQJ4r2XQik2bWlTDe9HCAGipakQlJdQhGQ3xPK2gBWFYm1xsGUoVTuM2FLbc79zzne__TZr7NTp9I8447CT_c7vfN95_s7ZTMPINAJWW_g_0zCM9jcYKaV2cOPmzvBhth3ONwzvL06wqr_l_cWNFp37MNUIFMPZR-DfEvg3xUAhOqIIHcidJ4Qa_vbwJBIqalGo9o4u3gc3OC9nlJA294_ZQ9JTNekNt83VpOnmbmjoq-NJaFqLQkt6l-r3nK4JrX_-d5oQ_cU1faHizywU7bpvAQk92qLQs9Vn9Tc99ulmBAU_u3aEzpZoZ5_7Rbh5ozn1D96_GKW_frI3Sc_QpBNDY3mfzXg9X-jxFoXK1_8chXYvTiOhmVIIonGCF40ZQsjziriedxY-RNxodMa3hXTsvfJqlA4MUlWCUF_zPdS06OYnUKhpyDtCqDHlehEJDY4X8oIbhZ6ubKdaBKIRL6zoVmCGxD1XUVl23314zwPy7FA6m4oqPZ_Gq4xWLshFlT-9pb128xsvDCSYbO25Pxp2kwqjSssLp23NIukc7d3gOfXmzT63-9WhJJ2reXeKSCgZqCA9qV9HXSiPhAKedws973YSuq2VJXcKTTGj5kk0linvWaFqithfmTXlNrQa2YhDF-65e-B5DN2_9-tI0kuajUI4W7HmDGqq67aJzi5T3QJnF4jSBU_B6Aahcy9fQKFZ3ikhtFwTeuWlP6iGAKH9L7yNt4ILk9CKOCGud_D-nif24tmFpQ_T2ZXq2YgdrcFMsL3yER81se493xQwB8hGrgkZQDCr4lS6VC1AZQaWQjdWPGIsnV2tXW-reEHEDfX45xo97tdoZ7HeA26Xn9yNuONy59HZtdrZZ3qZaKKL14vwbN6AWjpbqdm1T4cCFHpxaxa-YOnGDroH18kAw7PHC-ZjPmFwg6YL97yLQlfGTyShKk0Thj1Ix3aOVqXVjOALN6ZPrieY9drjqMUo3TJQLa8HH-Z6UQl5cK-XB6Km2bHRWLnt2NWsNogCCYyqF5BdZZBb33FXacGNFgGcwbu-izj7sBI4bCwnBIGlmk8JltiPLzZSGQ5owCs2heIv2BgYsweBqUM7VKEBGDupAqzwhZT4ZPbxOgghwBssXg6xtloEs1oKjFQpnWGkTIsYbW7NFv-BFcdyr4i4Vg8RKmAh6WPjcJxe1yr4-BOdVxzRjtDVXGsRFxPjqHYkfeQucSTcbdlv6chx7UjO3OuIco0T2jihHUn5wV36kdc0-w_otEHNLjAy5bwb7vXyBRI6pQX_N8gPMfkSiAY6e1qxZOBxIz38ZOmcmTM8GjixlQa20sD_Vxpo7Xzzgf-YBkbxbHM0MPZs7VOfAw2MAX9pgQY2fG_q7Xi2rKz4v6CB45Zu1JteKw1spYGtNLCVBn4KDTTRWD4NtDJXzUpGAyF8PisNjG2ecOXzpIGx019dpNJAMPplsrXPB2XNbuWD_wM-WMh8sLNQbXb76yDhM7Oqvgc28s7fPyEUmFl_-dj7yqlf-eXuwnlBbpn8leuVbY0zpuGbzIzigwI4lOWuQuCMjiUI3FbURQguWui45g3TK8QTPA0anWS8dJEggLe57zlsL-_eORLx0v98B8Lgh9luvQ8zVYPpdLkJYeYgt7HDkOsI00X0Q4DpSH2rITyul8Y0GSZr8BaEoQZuh6EfqjARxzwi6gvEPJV0l5W7DR9dGKjH53RNQ9tLD2FnyPxoZXxnMNvUPoX2I2rgkrGhcOVzB5OMlfHoWsrD06iK0HtVf7AFguR61wRVGqtNcAxltG29c_gSOUZ8JR2DFtUd_ZiG1-7Ra4i3-KY38KJZmBWOmfnLFxAPLRBxzX1Hb9E9XqLhtRdhAhFOlM0Op4gy7wWisDG0WJqr2ZBQj1PnrMDy1GVSP40vMzBdQokBqBPqw8H1wNWTWMBv4pJTMzBmAwAHy6u1nEwTDD_iBPNHf0loMKXPUgfUYmWlgFEL9ExNQwD5kh0q-uLzmoaUaZORknN7NI2LjXj1t87cqjP7WcmynuiRkl5sE0m8-S9qcD2h4dF7fX4Yzh0_EfHwWlArPzk2QRYjHPZ8085O5rP7u21CvCGilAEeWd2pP1XYF00r04tu4bKn1RmsVGrg2aYDFvVfC-mIXU-usq1_vL4PSzd9BZksPkD_rvlgOT7mYP4fURXzy9jwSw9pgxA9JhjNq4v3orXmeBlqaDAC-BiOkyhNI25wn2jtoOH21Ep8zElub3JqYg17sm9EDcSrbeuDF7eihr3iA8RJrYABYKRwCp-MwlfaHMXAu8TEBtWN48QqpPoZ3I6l1WGi4TTSaOnyV25Df-tmjMSDHUu06Ys1EGO1Q9U4Y9vWJfI0WUCpn8Hd2xysJ9QF1VkjWwPGUQCAK9_-JgLXiVjytyKKscmACmuSo7Qc1Ri4SdA7AKafGGxrbmwnAmNUQEjuxz2dG6zf0VUAs4NVQpqrAW_nZrUdc9u2yoUQAO_Iy49v7cFtg2wtxOWAl2CByatr4lsJB5djUplzou-z8zBgIDxGCbYDGoALkob8ZHFHtNgOywUlx50_v7ONg5S46kh2lwZM6WVz5tlsUYct6vBo78TmlxWjBp5-_EUDtDjSMEzTQBZQjMPMgO3mV5hYKlYE3zhyr-DXxECBpuE3w1_SIvsK1UT6CqxOOxI3eOTur2GcNGOc4WrpKvRJYXALtcxQbyLyocs8PcklxEKsMH5kh_wArNBuXIOtyeZL2NbZNsMQ7zm9ocWqhI1BA0m5UQ4Yy1_vLNE0bOSGxr2Yy5ITXChKF-DxXCpTpkGyr8DSJHHiF77hgivI4q1EBRMLdbxfpuEd2r0N8ZZ_60HEG_TIVcTDr6CQMk3kQuCXOQviRFtMMPDJX41JBkxx4lDfBuATe7-AmcIWCPk3XqEB45ANwCW4z1MscBT3JU6DrEbyxluaeiKw3ILKTUdCgpTj8s-2cMHhbxk4QZRmxfmqED25-0i4sewp0hT0cIfru091WcrlKccN-YVvdbLMK2hbhRrKsERwVDTnRZPJvlKh17QILCu0tuxQbiz5jpLSa5MB07LPtsYRmZbAfhdMMIWyaKrUgHfU3Rs_TniLC-op4ivAozNKj_KjYl0y530oHAN4o2a-qjpPuV8Dd2l_QS_XPQntP_uH69RtpCzDgEf12E8HpSCs1_Bwa6Q2Z-l6dLTicb8RJS6J0ppdEoECKtR26NL-i5qnsEKUlAbLjx3XYuGsOAw1sjf_OoC_JKhXx5UtcC3ac9qNPKcEH8BZ2omVcavL6zpTxWlubSRNIWlnnqjUgLeZJlM58jLXUn9CSNHuR29Qaq3kPdiTVUKF9S6OgadKPLk2GpmTnZPDa6P28U3I_NP5_qhmQ8U9qAYZhLrtkoSQxzW_uxmHkuVYHf2-Y83n0HhdmEEZJYKnxaZSiRFlcj2sAWOdVVgQjwlcgqG24wAMwPQXN9pn4VqtjsndFwPzaCJH9nA7TjZqfI75jMg6CI3eTOBo3PCX7KHf9xihrc4SuCzNAgq_l8MP12JLaqCv3BBtw9Vf4I5pGsiQdujQ-1O0_oR1AvCo6_rkRxm6jycrQBsSOA93aP4Ryb9olJZRKvCJZBflyuFzWQ6PkAxvKspq-r2m4Z15ZTvi0fxmW__iX4jeGjFW48Z4OM6QpzQ8WXhkOp8Xk7B8eMThmHJCJ7FyuLxFd0Oy98ilYwKHkuHbJDyuzDNsY7Zo3EXf0PCwD6jBSn_hnw8lw4nzxxmlPCi7UOPf");
		// Krillin
		registerPreset(5, "DMZ4:42JgYGZgLGNgYGDiYGBKT2ZgVzYAAw4GxjwGNufS4pL8XAYA");
		// Trunks (Large)
		registerPreset(6, "DMZF4:L1aCXBV1Rm-SZAlYISwFKhihKCC7EkpMMJ792YUFAZmEMXSwUIDgWBYJIj3XgpiO2nLFG1kzcISQBtRFlmk2IjJfQHKrigKggitDm0zlqIOI9177vn__5zzzns3LyFMnXG48977v3POf_7l-_6bVMNINZKsVuz_VMMw2txmJBfaoT1Z2exhvp3T2zD8B8e8xh8K3dCYEyf8T1wzwzBSjKR8ZjSN_VvA_k024loXOqHlJ04CTEU9MNMbDOPFwHgSJq9-GGZ9rR7rGUHW2bQJNIrjEu_0yo8QZmZCmLy8vACX1PxicCeEyW8wTKxLzP6HxyHMrAYfKtY35qUuwxHmaRUm145kFA_TYH4_uJP_lWPes7TMf3DN0PKN-qFmI0wKwqS2GKzBHMz-I4fxBvx8Hd9W6MknlnE8r7j0LMcLHxi9H_HmRON5h_pd1vDW97Q4ntX3rZ_AtrZMnYTWz2jWdQeuaNYV9y7k1pFR_BO2CfYbtJ4vrFkGjfczqCUYLRm0CPxYWlrGN1wrYiypT9R1xP1J38Q_6Zf4J_2jfuKEMtMK1N_muuH11V3AqLcwGqA6hBk92DlVM9p26E7daKBmNJl7PIHRIM0IQi6BURYaNfM9PsH3eFsIajBiMPggYawMyHw3p42AKdZSQlh3KS3RrEehtZ_waP1y1M6jrLW1I2TtSesVQdYxO4_QzmvlzlcG7bxB514VfO6yxOde3aRzr2nSudc26dwlTbrv0uBzlyQ-d1mTzl3epHOva9K51zfpvjc06dwbxc7Zw0L_gSX8w37CN-OVumbqpExeqWv7Dh8DuLn3beWVmr5yqqFvsJVWbzahdnf5dymcct-yZrhCc9xf-SuvQUeaB7uxI59SDxDeWjRwJODQji3JHZLi-roevFxOfzS3GckazNw-Nhy4Be-u7MC9LnwNMPm928GBc8bezQ_st1nYKPrCNYe0Wg8ryEaeIg7e0kiekWu06DGA_8ccPEb0MP92yiGcMo_WoeWRgKaj_ORo4p8cS_yT41rriukNNS-9_R0wEr3BOCF6AxhN4Z1bNXo-r5dudFLrQqEuwxOvdEoziums8YzeE0YtjaQ5RvOcZwsXzJ3t8-_H4vJvxkau_Gs6v3Lrqze3x2Wdue6786bcC5GYunaexshTjGi8SNe__h3YTdLo_TdBzWPw2s-6EYDXII4eg4dVxM5JhoPHEFLm2W8_v5_jRbpdelFj7TF4glt2ffXTRPTdkngzA_C8S840wEs7nZGIx4djeXwM3vuFUwGvPT9UvYQ-3D38J43Qx-BdfT4P8Dpf75-I2UdSzlRpzD7lJpi9z81vJbNXlMJNMnu4zaKi_EQUPx1IegDFByflDx9TP9e3Q9vf-AxgXn_9DXAxPLDd0KEiCyN7NfZPd_fKazlgjQ9uaAuV7sklW8A6vD1dEwZkjUs6ocqtz4E1PDDrjRvPg3XWfVs1zUDWcG7hR6V-mSPvqADrn2amaXKCrEu2PAvWZZlpmvXYFZvAen2_y3F1hWINbVe1ptCKRCZXxxUYNvqIWeODG9pU2RasX1j5EViLCNCUhh3aQNUAH1x8YBefsmA1WO_ouPkWSA7rRuHURksOb_m5iWBdOf5qoyWHdN_K1NM3LzmUq7sJyeE3rEZLjppjvKoy673nJjZacpi9UoCvRCqKhzVacngL7qkE6-vpLf7PksOb_t1X4dzyxhouOeS5l4-6qwmSo7lItoZLDm8Hzxu28wnX-zdacnirfvgkWP_ySm2jJYf5RMfNeqJvaNK5Gy45egBJjCM5fBYWLTlM7XbjSo4R60ZwZO8fUEtvmeRgpEbFY0RgOlcPt057INN1In2mXY_WHl7qt2u0jGyY9rCxmsfrih6VN2ue2PaRBncmj_qaNXbQIk2xxFiv7X4hoEhYop8LMUPW2EodgokX7pJUHNesV_EFmPWKTbdr1iTkZJHQBI8dejmjULP-Vbc2MEoTpXX_0F2a8iHrMgo9iNy4DUl0RU0CUSjHsw5lj7oLrEtPFiXUQhNIC0GTDXf8Wx8egjSrtHPavnCKrxRO52om16le82BnlU0WuvSVO4KpI00U4XHDLfMPcmAz3V0LwC1BxTnhVjy2mZxmlBvwbptZrLPd6Rpe8_svAl4lDxsm2r544CHAa_6X3gADD_PdagmTp8Hc8eUhgMFYs3NYgQKYdrN_BDBpBQ9Aw2S6X5NABJPedxvAIBWTkgBhch2KCcfrULUEgHFxKbKUOftMbYVWdU8Bn8YstwnGCbfgHFQZR6CzWbXNFkmbr-HhtpSDN9ueDnhwXvU-yAMhvHpVbc0KupiSO8_BxVw-WocXw78SFwMe1S_6aQ2vNRe9DG9Zp4-jhUQ4FRUAeoDlXdXxbvqNF2h4bXiYsAjH6QSpXz8QuY9Zba0qb606UiWq7SZlavqLgHETSgx05NxYHJxd_Ys3jgV4QNGbczRgyAYGjLVYyclmvF7nOpT0TljcWQrpGmoLfivCFeZqKyQBm7epeSorJM-YDIr7UdDgbti4Ugtb_-RsD3W45wPPC8r6A1y1qelFPhFTQ_pEDa5nNDw8rz0CxzB2zqBxjwEebIsVwv-cGC-KEWhc6dr5QXeG7MbO6cdLGcNDrzvVH0zoDq4V6YW7kMLLv1dcoVCVL1y33g4VGzW9XY1XZVv_PFMVLffD2Pcda8tXq-AwKOFdcqAbGVr3lKZtqaN4WTuib9HvALBCjZEEh6E48fofHgcrVCHhEcRWvlgV-pdW2D-gPayASpsmZWyFt2lktpXDMOA3eT1hwDQE9thXmjQm4Lf4rIFVN4oTn-EC8G4orQ5N3pzabJqt4FduTU-rK0TiwbQCTT7TCu_yosG2jkLdturwptED6jh3304n-o2dTxQ1ZU3A7-z6AwCXf_YDAN7BY4kBw5qqs9GBcozosbTSRDcBH4Ihi20WPf44ADMapA52WEgegEGgG6re04ED0wUr2S70OAHvpma1G3LbtpZzIwaM76plaw_t5JxUDXFFoWsewAmKbCUUXE6YRuZyMAYBo8w-vC83_AZXyA6Ku31QIpQJKMWdfPlAPg5h4rpe-ZJBCPw9DRjTy6bMs8mjDnnUoSm2E1lclA8rYCy5NCJzI5dplJ40WFsBPaA4RwwL0W-ywvgzwmjniBG6rIlJQ7QV3h-6S4vsq1gT8SvmdVahAfjY9x-BOInjnKFBk5dt2DJJw9gmuypY4WfYKUNLocLIyDZlABZrO0ZxYdMmbOs8n10KAaI0NH8wokkSISp-vfU5bV5DK2yihka9mMqSE1rKSxfDe-nucHTK1Aj2JSY4epzIwjeUcwVRvJWoIGLhekvFNGqlhndk307AQ5FiWyjnHPyKFVKiiVQIZJmzxCxZjHsI-PTvRgcBY5w42LcZ8CmuJRXJYModr9aATw5ZDMAF_OpVDxz_7edQP0U1EjumPynwD6MNiWISBFWPbXXmxFHUT5EgSrOifFWInpgfxexY9BThCjy4Q_VdUl2ycknluKYsfCVBmYdi0fbH4GpUxLvFMJF9pUKXJgQWFRr2x1Ka-JjYseA7SkqXBQF7nP4z4LE0lSdg2QVjXCE5qhhaEfCeHQ9Hywnrx1zn-T2Ff8Xw8DdKj5JRsS7o8r7mF8PwRs49rF6esr8a6tLhb-gPjcRgK6b946sQ21rDNY0owwwP67FMB6UgbNDwIntHac1ZXD1ctHLjshHJG98o8OINv9gCWKhtk96fyJuCClFQKN_-iVg4z3-sTK88-Ls0deuT-OCBca0LkLd2LemU0ETQ0k6kiFpdVoe5Kk68KZhwhaCdWfS6oBKVqZC8xLVcU_AeMQWj_eEZlForeA_0ZJVQQb2LYuApAk_MvB4aOGDgQJp5tYluQuE_X-wJy1Tw93BsGWAQLBW-4a-3VEJIck12NzEOi8kxnNba1mIKjTPcDYqUCH047IvoGFGU61ENGOqswoJIJlAJZrUdBDADxk9cD14hqnVMDNEImKSJkOw5rSnZ6BViWMwdM4jAodyQ7xKVP148HsRlUQso_F6IH6rFllgBv5KvGWWCxwzj0JG2eeTaFK0_QZ1geNh1JflRRPfJoAJUEcN5qEPjbFfZqIfDKBX4VNBGqXJILkvhYYrwxqKspt97Gt7Zd3YDHuo32_ovBJcT-oT_qY7KjeHHUY78QMMThUek80WuhMXBcx2KKcc8DZXDxSLAYkD0HuPDIA4lwvcQv3FFz5CPyaNRG_1Yw4M-oAYrfuKYgu7iJ-p9nFXKgzILNf4H");
        // Gohan DBS
        registerPreset(7, "DMZF4:rVp7dFTlEb-bhEfCQ4hAwVIEFB-IkBBKg63s3bsHscXiOYqPwqEVI0I0GEgQ770tFvWg5RQtIhAgPEXFIA8FodKI2d0QyjMtQglCEVqptRxr1R6O2vfcb2a-79svew0p_sFhz-43v5k73zx-Mzd5lpVnRZxc-JdnWVb7NlZWpRudv-ol-FDhxobsuTX4xov-vE_H4Bs_-CbbipTC2TL4vwz-z7JQaFG_9ULI_vuk8eJs3d13zqOz0_SzJa79zM6vibOJ_vafg2_8RLvhPYRQslvtoyT0kC4kjYEj1Y8OpSPlhg0vXXMKz-6YlxN840fv6n8SDYdvSGi6IfTCy3EUAtUo9GzfShT63uG-JDTDEKp-4WUUqsmuRqGf9T6O5ilNFYZQFRqjaaJv_OTpXjeSUKUUglu5LbiVNii9ZZCLlzFGXAZIH_jle8J7ybEL1wqY1L1-FcJEBhNMNumuGdhV6E4efu53wQcvsWvMGwiz_1vfNRwbKTAsX7u-C559dVO-8ZSRYcbZxy-bgXaCmfpTgp17P74H7cw-WkvSxYadZdeN0kMOpPG5QXrRhLtNO0fozhoXOCsXYbYPPoMwYy-3EQZvrMSPzb3jDhNmoWFE05tbUXrx8zGUPlQ8G43YcHYCxsbuzmUkvdiQxmsB6VLhc5Cu29YNdU9cug4dUHR1DUlXGdLJos0YJBB8CPPkipHixmJgMOKdquuF1szEpPMdhbc0Hc_OmjIR8SDEEA99U-EFCYp4f3IuQ_t2vfKuwIvK3I0sM-z7aNR2hFm67mGUPpP4Pkp_Uf8BehZijKSXG9KbhAL9Onae-yE-wujyPSS0woio09FtqJIKk5cawPfy2xGvoScew7D2U31OP00wqwwYeS8ytNZcNQuNWEc1KzXu_BCSXi0thw-zAhgIsZuCEMsRRSyWnPYjdOw_ruwsUOqWfKenQLEhtdIrXnLzi78Xh-s7lO9BI_p1KhZSI6ffc5VZ-iLp0rF-c5ajqg-FA0r8KKtSrrayDKFzu94XQs4I9LCXZOkE1V8_CdWLpLOldHsra0qJ1e6KglGFBYWF8NC3aEVo4dpOaP7ALkfRh09Ud0AfcmY40wOnCdB9-u3DkQaMPN_pOv5KOtJoXBIp8KnkgNC8HsfMfnIkTcin4gZn7-z-vH4DwdljhoIop0HBpd_Wyz1Ic4EJbpSkm-QTtLciD1lt4w9XziyfFjTN27lpdkRcqoxanm3Y8AoqoLakN6GphlVcnrmfeNH1NY-g9Lqra8zeW2pI0xE38CtKY1MD6VUYeHp0PWBILxfxq7qmR8kpszQtUB7M2BpAN1w7Sq8c4KA0VogLYg3O48IIkJYBwF04jEeA9DOiuGuEQhmBpQJg6MyFUAxngqgQF0Qx2OBWUQxKxdZRjKC2t5piOGOH_virpBhvcZWKTT756UVQDNUZWqQYQZFvNcWQ1TRlb8pvNcWQT_mlFCOvJYoRfXtcf4RRzspMMaBMR-evxuybUzkphHTIam8_NbzHl5IOwOv172UCL0rdPQMNScTHXo72yei7KBpSN-zmb2BwwDN8BTTE5lSNyVQNoSGQ-h-cGpBGqjMQE9mYVSlpRkzwecF_k7_-IsLUFo5GmJ2vbjJJUbURkM1oTR2HQJCI_z-tSUwSBV0vWiG0Rg5emfiN4hiys0l-k9V6fkPct7X8RiZDK_hNSjGFMH7Dg2EGfqPo3MXzG3Wjkmub_Caa4UiL_EY-qtOz9_EW-E3yWsEO4Kysja3gN9ItmnQ4vxnH_KYLJnD3vw3ChFspsr7CjXd5rFFosvP_-kXwk8cB4nHt8fknEQWk8j5SmUOVoX3pbrzQfL8Kgdt3LkPgXOwoHu0JAK_N1AVGLlqTDby2okMD3nruhWep4Ntt_zIQYfBDGre434C55MMGhKEZy423nViHMF1FZgBM57LrZEElmCkGTP71GxGGZnQ33vP8EB2mxLP3ixILAcx7AVbuJz577xqT0E41NOQKTgE5mPfZEuy_XAntdoJDgv-eEgUVgNHZFX79MEnSSw08Mkt78BzRkQEPn1e_D_ZAhhYleWazi1mKPMZ1zuw7RxcjfpIXo7Uo7aIfNPA6PPA54tGE4MbzkfR4dh5Rb_IAtJTaA33MGy8z8DqKMIEI_-n91yJe1r8mUyDSCJWqFdVAOhJSMnvmYrNSTTOAyQgtBroLhiQfHK7-6c_3h3jABmcbfJWBMRs0EqFyMkdQzhIvSr3Zs-WdZQs-CfMOBYxemcsNDRGsUtwWdQ3U0T1mCL5tvV-Ppr_TdEUYJW6W9bRy0NKLfSKJAX-jB9cMA4-e1-V248aH3no74qFZUAj_c_C29JaUUK6tCLszGind-GBRygCPvO5xR_BsmV5khc837Qf3arDuHMm6O2HF_rWQLnGZRrnOP4_WYg2nnzxmRJ6z7pNF-DC7h_0xfWeTguGCevug9IcxyQ1oWHZoLmpIWBF8GI6TJC19fSJAoIG7jsberzc0vFFwKWpYsKwJNXwiWBNoIPrkqVUpMnwAJq6qjZdyqGBgZIlQ3ThOnHFUP6NbsbR6zNq9oKihBvrJTwwQlDJtXTfE0PCWKBpg-urVJ1DDObpp8oBWP6M7tnhYT6gL6oyqwAB-87U_IHD1uz9A4M0ilgAYderOJgdqI4ji5oUGcMP2nyAwrTJdZ1bqdQTGqICQlKMXk35J0rWhZKgBvJWb1VZi6858IQTA24qGpbd2Gpr0EI8UhXmA9p6qlXBweTaVOS_5MV8eBgyEx-hL1qAGIHbGJNgs7nbQXB6P4IOruFPzBftYzWdqzPumAUzp5XLmuexRjz3qJahPeKnZc0tRA8WSn-RNVwpaHGkYbmggD2jOYWbAflMVJliYpzuHleszYbGhgaYILbI_oppIP4HX5ZsSHNE1npthBs6RMzCSwuhGapmxvpalM3jQ8AR1yugcrDAZVwgLDItxkQWlkIxwnRPthusbLa2hpVbiAM4bMvA6B4zzi5pHSMOzhoa13NC4F6uN2xxRurSVkUyZhGRfco4340QVPtrxcPHWooKJhZ9Uc_JzBt7eHVsQj5aRrjPovvOIhz9BIZWvj6gQqDLnqBcriwzgw78aEwZMceJR3wbgRjEpQKZkmOwXG8C0pXBjZfTaUHmARlNtESQt3tjQ2xzxl4QlyPzjdyFwT0EcZf2UCaI1K7k70Gb9qjCLZU-RrqAH97i-K6ortzFqDFaFb2lY5hXnrkQNc7FEcFRkukWbyb5WoZe1CCwrNNoHKc18TFo8MsNaa3kYMI_9vEFUwKoLNnOF4qhyNcLA2zbflD5OOPeKOS_oKeInwKMzWo9SUbEi7PI-FRcDeKN55YCXp9mX4C4d7EYIb2VY-y94cgXiLREzjSzDgEf1WKWDVhBWGXip1282mrO8erxo7cYzLQpXS7xMexlQQIVae8EjbworRFlldP7BQ0YsnBCHoUZSpfaTuJTXTR-Pix43eZJWSvU8p_CS20vN5VZX1K1cx2m21tFdIWknrbL57YY28jLX0jfiWYZ99AxarZW8B3uyTqiw3qUx8GyJl3kH1DG9CcnVorNmwQ2oBhkEpALt2jRCyOOa6m7W3rAc422ZM5tD46hwgzZKRI_ccDY9RrTJdZ8BLJe_zIJ4TOASDLUdB2D9rwZo66bVMWu_AcyjiRzZ43K_R43P43cvXqovEzgaN_wk3ZMfU-8eDoRxWd5bK34vhx-uxY7UQD-pF7cqwa2DhgZypBujvz7Q-hPWCcCjrqvIjzZ0HworQGuacR7u0EE6pxuapGWUDtwYZihXDsVlOTxiMrypKOvp9xsDT75ioPnNdf6LweVF37nxFoMb4-E0R75t4MnCI9P5lJiE5YOXeBxTXgzfAQEwFgGIAfVO7UgYh5Lh2yBuXJtn2Mfs0TRDjxl4jfQ2UAUrfeOpPwyib_T7aNLKg7YLtf4H");
        // Raditz
        registerPreset(8, "DMZ4:hZh7cA1XHMf3JhES6pGitFrxaj2CvKpiqrt7Mx4tw4yiqkNpBNF4NFF2t6XpdNKOmVSDCBERmmqaIghSGuTuJUqINl7xKNUy2ma0RcfQVh_nnt_vnD33sNO_7s6eez-_c36P7-93bqSiRCgeb6SiKK2bKCGZhtbutxjykGJoRdUdyUOGkdz63eOBJVOL-uWPwJJZnf9sh8CSqU4YvySwZLEl67l5U54MVTxphDeNfKaTzzAFwM3SDlKwHmWtAnCzlukAjujdhvJ8XbUfgddkZm7gjRWwgLxUiRfe8yLwSrteoDzv1T5DgBf-c2_AwEOGVe1gpkuYVtdrADO_SylsK3xSNWDazH4VMC3T-9DT-ZJHdUbMDAkT1XczYEYt3wCYDrf7i5gUU6utj6bHtNtWLQYwGrd8d670pBvV9o3YjRZmShYiGidTC3bknXxqgWFMrWnZQvDfBwPaAxicnWEdSFQU5KVJPNyWcPCwLVHAg_OK8WAeUDH0lkZMIXiWW2BWdzoLgbl8pBEDQ5d4YMCjcqBfl3jNZ90F3pL2Z2CjUfFvAS_y803AAw-kWFrV0SfkiKdLvBY0TUiGvzO9F_BC7qViIlIfZ5j-qsLmoiNTLDt0_koK9reZ2B3BsyUwbkLIgXYrTosHJ6H_8G6tiwc04mwEz5HAUA0ErOYUSzUZ9lkyTS41cfjj1ILGYxb6VBm1oGPCWHbqhVtoYa5kwVPaGiykPrZRshAyYxIF6y_Q9CVg5doB2Pq5hm4UrFcuCUPwPLeq37fpklRezCfVXEXwjZhcb0g8PK8REBrgxY9-EXiwrUxL_efYGC5GlOdzXJvhFrPx7T4GXj8qZYSHXjerT4ztCq7l5YW7sFikrUBc0UImt0CUdUxAWR-iptSv6K9TjGoMleH961QVNcWWSCXThwzTW3IzDw5zMPEHMIUOtPxJjZPBlCcm-DCqnVAeHEVvQV02WPApHjgMyxO7_6HRYKEqbhhY6BVaCIepX3EaLfSVLOyOfRgs5BY0gIWb27aAhT30geRJGcUQ8DaqJwTc8e8CAJMlBPeTwLv6XQZ1Y3niHYv6qVaAtJr7MZxmQNTAAi5Zvh7eRyETD7ZMRwv9JQv7qWiQrRcXnwcLjRhp9ICgn2rlVhP0BLugZf_ZvSWCYyXw3u3fA7jw0ssALqe5RMBgU3Q2OtBih7FsUlYIjpPANbveBnD2uHEAXuDfCWDICpKSpF8AuHpHWwpmARaq3RMvgStYs6qA2ja8OfRHBLwjITG4tatbYwwpxT0Jbh6YtLokuJWw5DI1lDnTvsGCBwlD0mNYq_Vg4fq6T9FColveVYJEGMkeOLiTd1xGuI9VLFzLLlwcj-CnJTCWl8Eqz2AeNZlHTR_2CdO_KDsNLGAuWXYNTVtSlKTFoYUBkgX0gOAcNhkwvzkK4w8FRXCcw4wLmugZKFn4Jmm7lNm_oibiEvE6UWgA1z7zPOTJA5yTJErXWGcoVDdjy9SjafAyDJ2ECiy8h51SzQKFcTJbdxIwV9pxCbQmg23C8J5vOgB4n8gNzV9EfUws4K8smyWM96OyhWhhmWRhA2torBczWTLVLCpdhLe0sxZcMj4-fXmWu-SJI3xJdFbg4i1kBRssLDsrcyryVki8w5VbgZf3ygTgxUy7DTxYIkLKxkQmBI7MeUmeIDhPAtd_OcINjHliYt8m4ON7HoFKYR7QnR2vlMB1AxcBOJ2GXvTA0S-ugH5yNeI73lzTCcDkMAjOdyuQnLMvAbgDHRy5fvICEZoVq1dh0POsctsx7yncFXhwk-m7M-qyX1nslmPpjvCtdqu8gRFFYCEbJIJlxYOiqLFhX1Dogv8Fc4WG_ZGSZvMY3zGfd4SSXuMGtun4T8CjcJjmYKcL3ucKZ0b1FErgHeVDg68T3tfoPS_QU-gS4eF3hB7lZMVat-DdooEhvGFzD4nBE_bnY11a-33qROQVubX_2PfXAi-f3mm4DBMe6rFTDoIgrJN4_p3DpebMQw-BFiLuNCIn4sWcRx4WkIcQorlDA5obBgZQqA29cd81KVKgEOmZas6xOikXztMvE41EpbYCo4e09XUbvw2eodlob6rLojNBItgg6t--4B6Q82hchY6E5MDM60ELIbJz-CCaQLWbWCjFuyq_BLPpy9L5JKSESDvGUwnqyych6NLiiAUKGDSTh3JeMyVkRorStFvskLjYuDji8pEBl7cIbkvaTxd7gJn1uYPADMwUpDhIhkkjIrvAOf1OOexWdeXU9QS8iCXLKeoG4XKhnhx0NThrhLvsEQkMyivMReziwESZhBKuxASMbyy7S9YaSdmUWgnMLiv8Ep_cnJUftkJTW0rrkORINBvp8AJi2RgnS_-u42C0cNRtusXbgTDx8-sQU2cvt4BLll5C4yCWvHJMsoCONPTDN6ZIHQuUg_CwDzvjkHANr3OTpPX3TUGsZwcKPHijNv49JYKPu22UaYkz3bL00Hl6o0yL5fe1xGvYWwE8vNEZ3n8huUz13OCR0rQMXw5y5AmJx6WIl_NFejfmB08xWU6Zej3852GhCJAc4N1IOek2VfH0raERF244zMfMo0EbPSPxoDOIyYpvTJ0PwPhGjEeDIA-eOUp48puZ8-fOVv4D");
		// Patreon (__Travis__)
		registerPreset(9, "DMZF4:7Vl7cBXlFd-bhEcCRUBQoBbDy6LyyEsgFN27ewehxYlTjI_CYKHhFQ0GCeLuUiiOxg4dtCgQCCGAosUogoJSKUJyL8QiL41So1DEFgZbxlofI9J3v_udc77v25Pc-ndnrjMOO3dzfuf7zvN3zuZYVo4VcbPF_zmWZXXtYGWUefFNm06KhwWe89ilw-Khyrcn9ZevAmf7s79PvgqcZVUzMq1IuRCaKf6tEP9mWFLaqb79dpD-ZOOvQHriVe9L6aYhbj8uPSssHb-j99PtS_vxazPrJEzcXrFJwsTF-RBmNoM548-UMG6PKYNNmAV-_EzfG-Euhz6bDjDiF4SZw-4CKhWMOATeznfqlhYAzIV95yVM075JryHMXAaz_Ir34FItq34XNkl82rotcIiD3SpQupxJnx17LoVJojPgWPouzsg3bkWYexhMhZQWd8k8sVcKudaWB0B3Q2YdCt3LhJpHfAS6xfGkUPRPp4eAplmnvkChCmb8kiefCmuKrwPjB1Fto3lhIcL13Jy18-FOJ4r-CMfrtXcpCt3HNG0deAqE-p95DIRW1rZye1YqIRHnk5Nx3gGkt8yYIqWTngPD3gl4fmJC5RuAN-GyzYAnXAd4kWHMRpgTXhxsJGBKB2wFmPmWBQao-_BHAPP3wd0QZrgJU-XZ4_rkSLzEyJpxgNcgo0_gPZFbJf29f_70ayCIhUmSrwLb7Xe_1JAgZx4YMHclahjJDvr8uangTJF-Zl6LgypPrXj_Tjjo7uVZCJMXhklkzfwKYCCTDBg0pIA5_89ZAKOiJJJvuqE06Ybu4AaMXSO-fyjvK5KsAVM-Wt_YV-LZd92xHPFWfmPlIJjEMHliIw4dfbsnmBtKro7CNYde_j2Jl5j667MMb-vkT8H6s4eeBmCsN0FiVU4LAj_JgMuv6wHAE2VQiKCFYylggWdTbVJlQYfdKnbfAcvWw32hEikYUaQekmVGHAvzwyi4kdUMBk3iOSraIAmE9KxvPwvSP2jJRek1LKT2XLhbSjcKvzAjqdhfCNkQNA2MfowwNewQu6UdzXJNh3AuZsxhxT6ylknvnDMNpPvIu2hLBHGsX4Gjpdel0K3DGdJXFEj0VBDX5qtlydDvL39jJyfdztsyy0I5sJ5Jjz25H6SHPO2EdauK0fTljCkoXcdOTsZ3y2-8JWx8t6bieoDZ98KHcAjtww3sEFg5DPOpQyx-5jmQVm0lUs-ke8uUV8XecJ3b4xejeRBvZNKUC46qnVSC45DGwo6UtLpPRzYpGPGwKPkgasrNyZqSBcm2tGBxWMGBrBd7goLxMqqNZCO-Q7f8n0l7IFtWIoHzcF0XeVAK_cCeNsQFQCy0huetCANGE3uJK4d5UGb-M-oKAH50w03haq81TL9mEdik9WIZ6ydWBtOA1_MSo-WD0HCJyn6x5CMCD2xh4CVKChYjXqbC62xlzCmzOg3Kk_8JS99CTVSowQZktC1Vj9ZCIPg30UVsdRGyvdvl44tScWyQImGHWI1BHmAkKHG5RB-kUe1xhcMsWxSM6g9Q6gVM4XcboIlmPHID5ylHGAzSPS_ZQsLdTzEXKimBowLfOs4uRRwbhczTKBhkbEb9td4ynBK5z-oYe6BqYeW8JIm_LU3i0yQ-TeLTJD5N4tMkPk3i0yQ-TeLTJD5N4v-_SHwpkfju0i_R3n8dBsQKW6cX6_7Qcakp2lPWrDK_sWZcn7Bf6FWQdBnj91kQV9HO5QfhCj2DtQDcGXM3mi2zRfAAUekBr8PclaxvK8ZPeB2hh3qOInPnrh8PeB3_fB3AwMOCoFHDzGYwl33SDDDYbrxYx2mNANNj3o8BphtWxaZYydWM8RNMz-HbAIZIbKzPVyNNGMG6D7fkhlkYKQ-avj47lAfQXKYhW1ZtEUk5X9dAwiCMH-3U8CDY7-dQCwI0tmB1RZbFxgPCw2MZF6dSh_c1_UEWsNH1QVSoYgNDG8cQRXA_evMCOka-Uo4Bi3JH38vwutxzKTwOxXrKKi3wcp5_AfDAAoLw7T3Sn3u8guF1lWEiIvxns68FvAzJOpOBCJ3RT-yVRVoZUiRV5sI1UOlEw2ajCAHjIYwY6I1zG15cuB5H43YsEFU0R40rBAzZIIBxgjVyMuu5mAwuu2jid6SGqPJZJlYnBwPGbCuVTENkK5BqB7mboSEDWJKfrCYAbJ0_AEf_oHUQo8XW_FRZj4TCSC-yiWpT9IsZXPczPLyvR73BixXcehvgwbFEk_j30cmqGDEGaS1I5TMaA2IjZCkTeGh1v_Gd0oFgWpVeeIqAPG2uFKqUBhobvwUd77dSusxrRFd57j-I-uArkcnyQfSELZ-vhssclO1HqCJGlii-cDebKPEydrxwe9iLbu2xatDQZEXgMhQnSdICGvbmTwANuLUweddwpuG1vMtBA87Lnvv5Sy-Chj3yQQ1fAvglWU8EcN9_1bKFQWQEA35VEm5R3ShO3FKsn_ZOKK2a1ySLGmjAV8aGSI3vaoolDfuR2ukWegE9jRYw6qe9e4cfHiCNATyPAb_-8h8AGKm3526XsSSAQadpbDRgQJcxCXY-A25-9afh1Zi7KPEKAENUiJDEFURgN-7qJYHJweb4UMCAd1KzUhPQCikkgHcVFjHKtQOIpjlIFaayAI6fupVQcPlRLHN-_DNyHgSMuSsRDAs1FKWKO5q6YhHavVDcabZLNrYxcYMktUTgGxgwppdHmedF1VIHLeo3YZ_wE0uqy0EDxpKeExOixaGGUUwDWsAwDjEDspuuMLhPMYxDyo2aGBnDNLxd_DKL7E-xJuIrYXVknYF9ePT3IU7aMU6xWbpKNSm0t2HLdHJp7lJk-GHslPYyqDA6svWmT-1c6MRboDV5dAjPPdlpFOA9wxtaol7aWGhAqSBOAeP-suFBto4hDU9RQ6NerPcUy2TpEniPw8pGp4xexaotDI8TXfiKJVdQxduICiIW5vy_iuEd2r0D8FZPvYttdeCVKKRqWYeFQJe55NDM9jIE3PKbSamAMU587NsC-PieKyFTyALGwmcNAz42ZglbCCsLHJGbLrXHM0-8rfkqAFYDllritEkQ3CEaCwW0KCWI0awoXw2ip_Y7bU6seooyBV7cp_quqS5JBTTltLcDapN5Y7LrQUM1lAiKiva8GCWyb1To2m8EVhUazidSmviYOrHiO0ZKr08FHJf0XwCXIJlWwLoLtjGF5qhqqUTAu7bfHB4n3J_IOS_ZU-QrgYd_Y_QoHRUbUjnvC-kYgQe7deU843xN1KWjeulVn6r95z26AfBg16XKsMDDeqzTwSgIGxle4pWJrDkr14OjDY_rRqQ9vknhpVhFYaH26EOR4SmoEBVV9oqjx1gsnJR_LGpkLu0g9XKKjj5lcDfgWqcgb70DNKfoDxnV1OoKe1WyVV6bnZQyhaKdsBgReFtxMtUfHpBrmcuJDHY-vINRaxXvgZ5sEiqodyEGnqnw1AZqfH5efj5toLqGm5D-hLR55VhQAwxCpMKX8lOPSQhpXDO-Yx1KlWP0hcddQqFxQprBGCXsd-VXOiNGjMn1TQYMddZgQTQmUAkWtR0GYAGMvwS08DfqmNpxETCNJmpkj3WhZMPG50cfl1knQiOXCByOG0GcPp45-ovokVRcFmcBg9-r4Ydqsas04KvAwU9uRoJbR5kGNKRH3zSN_gR1QuBh19Xkxxi6j6UqQJvbcB7q0Ml0Dh9UfTkxgI-nOihVDs1lKTwcFd5YlM30e4vhtb6-k311VivhD-SC3-TG8MchQ77D8FThUel8Wk7C6uJlPsWUT1-mAywCIgZU77HeTcWhVPg201Kc5hmyMVk0dND3GB70ATNY8RffUXQXfzH90WqUB2MXav0X");
    }

    private static final String BASE64_URL_ALPHABET = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";

    private static byte[] compressOptimized(byte[] data) throws Exception {
        ByteArrayOutputStream byteOut = new ByteArrayOutputStream();
        Deflater deflater = new Deflater(Deflater.BEST_COMPRESSION, true);
        DeflaterOutputStream defOut = new DeflaterOutputStream(byteOut, deflater);
        defOut.write(data);
        defOut.close();
        deflater.end();
        return byteOut.toByteArray();
    }

    private static byte[] decompressOptimized(byte[] data) throws Exception {
        ByteArrayInputStream byteIn = new ByteArrayInputStream(data);
        Inflater inflater = new Inflater(true);
        InflaterInputStream infIn = new InflaterInputStream(byteIn, inflater);
        ByteArrayOutputStream byteOut = new ByteArrayOutputStream();
        byte[] buffer = new byte[1024];
        int len;
        while ((len = infIn.read(buffer)) != -1) {
            byteOut.write(buffer, 0, len);
        }
        infIn.close();
        inflater.end();
        return byteOut.toByteArray();
    }

    private static String encodeToNumbers(byte[] bytes) {
        if (bytes == null || bytes.length == 0) return "";

        BigInteger value = new BigInteger(1, bytes);

        if (value.equals(BigInteger.ZERO)) {
            return String.valueOf(BASE64_URL_ALPHABET.charAt(0));
        }

        StringBuilder result = new StringBuilder();
        BigInteger base = BigInteger.valueOf(64);

        while (value.compareTo(BigInteger.ZERO) > 0) {
            BigInteger[] divmod = value.divideAndRemainder(base);
            result.append(BASE64_URL_ALPHABET.charAt(divmod[1].intValue()));
            value = divmod[0];
        }

        return result.reverse().toString();
    }

    private static byte[] decodeFromNumbers(String encoded) {
        return decodeBase64Url(encoded);
    }

    private static byte[] decodeBase64Url(String encoded) {
        if (encoded == null || encoded.isEmpty()) return new byte[0];

        BigInteger value = BigInteger.ZERO;
        BigInteger base = BigInteger.valueOf(64);

        for (int i = 0; i < encoded.length(); i++) {
            char c = encoded.charAt(i);
            int digit = BASE64_URL_ALPHABET.indexOf(c);
            if (digit < 0) {
                throw new IllegalArgumentException("Invalid character in Base64URL string: " + c);
            }
            value = value.multiply(base).add(BigInteger.valueOf(digit));
        }

        byte[] bytes = value.toByteArray();
        if (bytes.length > 1 && bytes[0] == 0) {
            byte[] result = new byte[bytes.length - 1];
            System.arraycopy(bytes, 1, result, 0, result.length);
            return result;
        }
        return bytes;
    }

    private static final String BASE62_ALPHABET = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";

    private static byte[] decodeBase62(String encoded) {
        if (encoded == null || encoded.isEmpty()) return new byte[0];

        BigInteger value = BigInteger.ZERO;
        BigInteger base = BigInteger.valueOf(62);

        for (int i = 0; i < encoded.length(); i++) {
            char c = encoded.charAt(i);
            int digit = BASE62_ALPHABET.indexOf(c);
            if (digit < 0) {
                throw new IllegalArgumentException("Invalid character in Base62 string: " + c);
            }
            value = value.multiply(base).add(BigInteger.valueOf(digit));
        }

        byte[] bytes = value.toByteArray();
        if (bytes.length > 1 && bytes[0] == 0) {
            byte[] result = new byte[bytes.length - 1];
            System.arraycopy(bytes, 1, result, 0, result.length);
            return result;
        }

        return bytes;
    }

    public static String toCode(CustomHair hair) {
		if (hair == null) return "";
		try {
			CompoundTag tag = hair.save();
			ByteArrayOutputStream nbtOut = new ByteArrayOutputStream();
			DataOutputStream dataOut = new DataOutputStream(nbtOut);
			NbtIo.write(tag, dataOut);
			dataOut.close();
			byte[] nbtBytes = nbtOut.toByteArray();

			byte[] compressed = compressOptimized(nbtBytes);

			return CODE_PREFIX_V4 + encodeToNumbers(compressed);
		} catch (Exception e) {
			LogUtil.error(Env.CLIENT, "Failed to serialize CustomHair to code", e);
			return "";
		}
	}

	public static CustomHair fromCode(String code) {
		if (code == null || code.isEmpty()) return null;

		if (isFullSetCode(code)) {
			CustomHair[] set = fromFullSetCode(code);
			return (set != null && set.length > 0) ? set[0] : null;
		}

		try {
			String cleanCode = code;
			boolean isV4 = code.startsWith(CODE_PREFIX_V4);
			boolean isLegacy = false;

			if (isV4) {
				cleanCode = code.substring(CODE_PREFIX_V4.length());
			} else if (code.startsWith(CODE_PREFIX_V3)) {
				cleanCode = code.substring(CODE_PREFIX_V3.length());
				isLegacy = true;
			} else if (code.startsWith(CODE_PREFIX_V2)) {
				cleanCode = code.substring(CODE_PREFIX_V2.length());
				isLegacy = true;
			} else if (code.startsWith(CODE_PREFIX_V1)) {
				cleanCode = code.substring(CODE_PREFIX_V1.length());
				isLegacy = true;
			}

			byte[] bytes = isLegacy ? decodeBase62(cleanCode) : decodeFromNumbers(cleanCode);
			CompoundTag tag;

			if (isV4) {
				byte[] decompressed = decompressOptimized(bytes);
				ByteArrayInputStream byteIn = new ByteArrayInputStream(decompressed);
				DataInputStream dataIn = new DataInputStream(byteIn);
				tag = NbtIo.read(dataIn);
			} else {
				ByteArrayInputStream byteIn = new ByteArrayInputStream(bytes);
				GZIPInputStream gzipIn = new GZIPInputStream(byteIn);
				DataInputStream dataIn = new DataInputStream(gzipIn);
				tag = NbtIo.read(dataIn);
			}

			if (tag.contains("Base") && (tag.contains("SSJ") || tag.contains("SSJ2") || tag.contains("SSJ3"))) {
				CustomHair base = new CustomHair();
				if (tag.contains("Base")) base.load(tag.getCompound("Base"));
				return base;
			}

			CustomHair hair = new CustomHair();
			hair.load(tag);
			return hair;
		} catch (Exception e) {
			LogUtil.error(Env.CLIENT, "Failed to deserialize CustomHair from code", e);
			return null;
		}
	}

	public static String toFullSetCode(CustomHair base, CustomHair ssj, CustomHair ssj3) {
		if (base == null) base = new CustomHair();
		if (ssj == null) ssj = base.copy();
		if (ssj3 == null) ssj3 = base.copy();

		try {
			CompoundTag fullSetTag = new CompoundTag();
			fullSetTag.put("B", base.save());
			fullSetTag.put("S", ssj.save());
			fullSetTag.put("T", ssj3.save());

			ByteArrayOutputStream nbtOut = new ByteArrayOutputStream();
			DataOutputStream dataOut = new DataOutputStream(nbtOut);
			NbtIo.write(fullSetTag, dataOut);
			dataOut.close();
			byte[] nbtBytes = nbtOut.toByteArray();

			byte[] compressed = compressOptimized(nbtBytes);

			return CODE_PREFIX_FULL_V4 + encodeToNumbers(compressed);
		} catch (Exception e) {
			LogUtil.error(Env.CLIENT, "Failed to serialize CustomHair full set to code", e);
			return "";
		}
	}

	public static CustomHair[] fromFullSetCode(String code) {
		if (code == null) return null;

		boolean isV4 = code.startsWith(CODE_PREFIX_FULL_V4);
		boolean isV3 = code.startsWith(CODE_PREFIX_FULL);

		if (!isV4 && !isV3) return null;

		try {
			String cleanCode = isV4 ?
				code.substring(CODE_PREFIX_FULL_V4.length()) :
				code.substring(CODE_PREFIX_FULL.length());

			byte[] bytes = isV4 ? decodeFromNumbers(cleanCode) : decodeBase62(cleanCode);
			CompoundTag fullSetTag;

			if (isV4) {
				byte[] decompressed = decompressOptimized(bytes);
				ByteArrayInputStream byteIn = new ByteArrayInputStream(decompressed);
				DataInputStream dataIn = new DataInputStream(byteIn);
				fullSetTag = NbtIo.read(dataIn);
			} else {
				ByteArrayInputStream byteIn = new ByteArrayInputStream(bytes);
				GZIPInputStream gzipIn = new GZIPInputStream(byteIn);
				DataInputStream dataIn = new DataInputStream(gzipIn);
				fullSetTag = NbtIo.read(dataIn);
			}

			CustomHair base = null, ssj = null, ssj3 = null;

			if (fullSetTag.contains("B") || fullSetTag.contains("Base")) {
				base = new CustomHair();
				base.load(fullSetTag.contains("B") ? fullSetTag.getCompound("B") : fullSetTag.getCompound("Base"));
			}
			if (fullSetTag.contains("S") || fullSetTag.contains("SSJ")) {
				ssj = new CustomHair();
				ssj.load(fullSetTag.contains("S") ? fullSetTag.getCompound("S") : fullSetTag.getCompound("SSJ"));
			}
			if (fullSetTag.contains("T") || fullSetTag.contains("SSJ3")) {
				ssj3 = new CustomHair();
				ssj3.load(fullSetTag.contains("T") ? fullSetTag.getCompound("T") : fullSetTag.getCompound("SSJ3"));
			}

			if (base == null || ssj == null || ssj3 == null) return null;

			return new CustomHair[]{base, ssj, ssj3};

		} catch (Exception e) {
			LogUtil.error(Env.CLIENT, "Failed to deserialize full set code, trying fallback format", e);
			return fromFullSetCodeFallback(code);
		}
	}

	private static CustomHair[] fromFullSetCodeFallback(String code) {
		if (code == null || !code.startsWith(CODE_PREFIX_FULL)) return null;

		String rawData = code.substring(CODE_PREFIX_FULL.length());
		String[] parts = rawData.split(FULL_SET_SEPARATOR);

		if (parts.length < 3) return null;

		CustomHair base = fromCode(parts[0]);
		CustomHair ssj = fromCode(parts[1]);
		CustomHair ssj3 = fromCode(parts[2]);

		if (base == null || ssj == null || ssj3 == null) return null;

		return new CustomHair[]{base, ssj, ssj3};
	}

	public static boolean isFullSetCode(String code) {
		return code != null && (code.startsWith(CODE_PREFIX_FULL) || code.startsWith(CODE_PREFIX_FULL_V4));
	}

    public static boolean canUseHair(Character character) {
        if (character == null) return false;
        String race = character.getRace().toLowerCase();
        String gender = character.getGender().toLowerCase();

        for (String defaultRace : DEFAULT_HAIR_RACES) if (race.equals(defaultRace)) return true;

        if (race.equals("majin")) return gender.equals(Character.GENDER_FEMALE);
        if (race.equals("bioandroid") || race.equals("frostdemon") || race.equals("namekian")) return false;

        RaceCharacterConfig config = ConfigManager.getRaceCharacter(race);
        return config != null && config.canUseHair();
    }

    public static CustomHair getEffectiveHair(Character character) {
        if (!canUseHair(character)) return null;
        int hairId = character.getHairId();
        if (hairId == 0) {
            CustomHair custom = character.getHairBase();
            if (custom == null) {
                custom = new CustomHair();
                character.setHairBase(custom);
            }
            return custom;
        }

        return getPresetHair(hairId, character.getHairColor());
    }

    public static CustomHair getPresetHair(int presetId, String hairColor) {
        return getPresetHairByType(presetId, hairColor, 0);
	}

	public static CustomHair getPresetHairSSJ(int presetId, String hairColor) {
		return getPresetHairByType(presetId, hairColor, 1);
	}

	public static CustomHair getPresetHairSSJ3(int presetId, String hairColor) {
		return getPresetHairByType(presetId, hairColor, 2);
	}

	public static boolean isPresetFullSet(int presetId) {
		String code = PRESET_CODES.get(presetId);
		return code != null && isFullSetCode(code);
	}

	private static CustomHair getPresetHairByType(int presetId, String hairColor, int type) {
		String code = PRESET_CODES.get(presetId);
		if (code == null) return new CustomHair();

		if (isFullSetCode(code)) {
			if (!PRESET_FULL_CACHE.containsKey(presetId)) {
				CustomHair[] fullSet = fromFullSetCode(code);
				if (fullSet != null && fullSet.length == 3) {
					PRESET_FULL_CACHE.put(presetId, fullSet);
				} else {
					return new CustomHair();
				}
			}

			CustomHair[] cached = PRESET_FULL_CACHE.get(presetId);
			if (cached != null && type >= 0 && type < cached.length && cached[type] != null) {
				CustomHair hair = cached[type].copy();
				if (hairColor != null && !hairColor.isEmpty()) {
					hair.setGlobalColor(hairColor);
				}
				return hair;
			}
			return new CustomHair();
		}

		if (!PRESET_CACHE.containsKey(presetId)) {
			CustomHair baseHair = fromCode(code);
			if (baseHair != null) {
				PRESET_CACHE.put(presetId, baseHair);
			} else {
				return new CustomHair();
			}
		}

		CustomHair hair = PRESET_CACHE.get(presetId).copy();
		if (hair != null) {
			if (hairColor != null && !hairColor.isEmpty()) {
				hair.setGlobalColor(hairColor);
			}
			return hair;
		}

		CustomHair basic = new CustomHair();
		if (hairColor != null && !hairColor.isEmpty()) {
			basic.setGlobalColor(hairColor);
		}
		return basic;
	}

    public static void registerPreset(int presetId, String code) {
        if (presetId > 0 && code != null && !code.isEmpty()) {
            PRESET_CODES.put(presetId, code);
        }
    }

    public static int getPresetCount() {
        return PRESET_CODES.size();
    }
}
