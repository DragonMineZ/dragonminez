package com.dragonminez.common.hair;

import com.dragonminez.Env;
import com.dragonminez.LogUtil;
import com.dragonminez.common.config.ConfigManager;
import com.dragonminez.common.config.RaceCharacterConfig;
import com.dragonminez.common.stats.Character;
import net.minecraft.nbt.CompoundTag;
import net.minecraft.nbt.NbtIo;

import java.io.ByteArrayInputStream;
import java.io.ByteArrayOutputStream;
import java.io.DataInputStream;
import java.io.DataOutputStream;
import java.math.BigInteger;
import java.util.HashMap;
import java.util.Map;
import java.util.zip.Deflater;
import java.util.zip.DeflaterOutputStream;
import java.util.zip.GZIPInputStream;
import java.util.zip.Inflater;
import java.util.zip.InflaterInputStream;

public class HairManager {
    private static final String[] DEFAULT_HAIR_RACES = {"human", "saiyan"};
    private static final Map<Integer, String> PRESET_CODES = new HashMap<>();
	private static final Map<Integer, CustomHair> PRESET_CACHE = new HashMap<>();
	private static final Map<Integer, CustomHair[]> PRESET_FULL_CACHE = new HashMap<>();

	private static final String CODE_PREFIX_V4 = "DMZ4:";
	private static final String CODE_PREFIX_FULL_V4 = "DMZF4:";
	private static final String CODE_PREFIX_V5 = "DMZ5:";
	private static final String CODE_PREFIX_FULL_V5 = "DMZF5:";
	private static final String FULL_SET_SEPARATOR = "\\|";
	private static final String FULL_SET_JOINER = "|";
    static { initializeDefaultPresets(); }

    private static void initializeDefaultPresets() {
		// Goku
		registerPreset(1, "DMZF4:DtWmuQVMUVntld3sgrYIAQBJSAiDx2VwQrMHfuloJiYSIoisFARhYhi-Au6r0XUUSRIoUGldcuLCygIshDAYkEcWeGh7yVh4AQ1ERKhTIJYlkYoyE9fc7p7tv33pnFmFfV_LAcdrq_c_r0eX7T9UOh-qGwWY_9Vz8UCjWqFcoptYoKQyH2ocyOxEPh1AcnMoV_iDlJ9lVuKDyGrb2H_b8klPqntqm8vELdVOpE24lNo2q8KSE3FQdt8qhnSvVG-29SjtJQrL03SEBxcXGgVmNqvEk5_9hMWplSq1-ra8usyN69-0HAzL37xCZcW4JrcwJxN_C_lDrmBCFgXEYT0aak3HTfRWg1XtWKrcX78l07QcNNt_Z-sZY57q0px60Ha18sHp3S145WccVjTuKs5wThrppW6HrkTv6brnZtkpIS6SR1U88Us1J-wHf3u3DhW9h9FncnZ9LunWJ3d9ed2lFai4cr5deDa3to6sGZ_Nf21NaCgRVl_Dbla0ZrVT4fdq8vKFTVY5uEt4cLcFMYNxUU5Ls3JXw2FYpN7HKHpC63CYmscJtRTxoxJx4nvCqBN8vt5RgI7MLolDI8w8-4w0iYPCHhnk2zBFLEWbH2uSCjCcXBEKri0ntmuxXHW1EuN9HOK3KOFkawVt0NIplsyFMKjHIJczPK9jnuPE12muNWee9pvmt3-lOW49q8wLUStyJorc8JFvieIGYl2unn9zvBQrfREjW6sMqab5KSFmXc5HO4xWIT-_Ag-1CLBdgNqQDL44ekHGSlcpA7T2HIKcqYAziu8G51-4aA7cwB0B2dqFCLJ3U1SCCzplUnIfAwDSvHDOVoeOjmNcODxa6Clyvw6oZyRsdCdS7vcX3PHj17MuPdTKVH8RB56LOeGkxJ3hRJPrTTbURMiOImS22TTB_VTJ_avSso7fus3e2WREvsZDoBezT10K38tJIW2-sqe07U8C7Zp1XGqmBl5Kb9QfkFy4ljykbrba30eOqVKD3KpnfEprqh8H2h2kUPlE0cPy7VIQ-mDrnJ_1CHvHFG3n-lQ2bmnNfhBDhE_fNzNZFTW9_v1nNroX_PzGAqO5pw_xPbL-cwxvRel2JXsuhFfk_xDsYnbrUic3_akgPHvxg5zK-vZnjz2xyDzLjgkXytRSgadBnfHbnj9hlpO20Gs7HzSW8TymGMzXvacphqCVPiDhbj0eIrQQl2UQDzQLcPwc03L2gAeCu6NIXEmjtxDmSepsOu8OvPmVrr19wAag16dgmU5eabHwHgxwnPc0yD2S9t687wIjMXA96K3AW-52W2ljD-XT07b2V1K4D5-opG7tYyZWvN40edOKd1_oR39I11oFb_xlWA99RXu9148S0DX3fjpRxHmw4Ib87SKMfrN2HET6AFZCYGvKcvM7i16Cv1mKXuRs_syGHYpp-3K9Pdr0yspYGkIYTH3lf_CLvrz5ugDg4xO9q7XiWk0mWfz3a7VLLPmbvTziqlVjUaVAwtdnXhgB-rtonxNK65lBhjwtoYY0CUsbzb6ttyyC4scrQxRqscUglZSD_jUavMMylf8J9n4hDqyriRkGszzjMpSRc9z8iMeTHzTEGnFRc9zyQ-aNXXM89gP8JzSsyKHBzSAdxbpIdJPftzmGoRLrjYSew8O0K_lmv0RgeBDQx9y8AosSOLXvgDOAnKtJO5hzeDhJKrrgdvafqba7VICvfWVB_O0zXTGK6ZAS9f8RAcHEPUiQyFyuCQKCfJXB_x-gSNdlPKj2qjXa8WS90JLfrYc-9qmcM92rHdC96_0zXjyaBIVvLMy4JsJI99VvZ_u-KhtFMfUyLWaYW7m07FVto5kG0ahDlFtuBTykYGDIQzKkthU-nVq-C4X9_0BOyexU3C9JTBGzgQPv9SERwXKiPbvWzkMH135skQirrfZKhEceBkCEdgF4W1XI02fTJc_fL7Wrlfxk3NZL_BM6YyYMmUrI2IVuSdPq9qBWI2yLapMjqRdaiWcf6jzqCW9B_3GEl4zJEwN1txEUFUuRM3HWinHVNGZIWGB_fCjvkFvw5xTDX5Ud2XddozhYKXqFNoBS-w7IJWnroLlGDnzTSFopc4cazTjiEKWPAUCgHO9CR_VEIgcApdsrwJbFrD847L5tkp9N8yhTYMmELj6HpK50rXr_QvNZ9CqWqpfW_QFJo4XPgnuKaWbY5d9BQaFSVUn0KxsYnZ1F4p4-iZLR9rvq2Po4keTy7UO-OgcTTlt7BpOc-Nrk2ZxlE72n3HLeAX7IPfXMoyF84nNga5qP3s_CKvhA5qzjSGDw1qXnlyYT8QeYBXSXbdw3iKYLZv-8FTCHNIgxnYtqHW9q9c-TLAYIF3aI1jiioeOqJ1BdgPKz3uAJi-FG2wc3BM0dqGjgYO20PUYbvMMlr8tat7wChq8hj86GA0-_Pf1MqnTBr0Fe_ttYEc87NRd8w2uO9mzjwArtuoBIDrgYnl-GnUuneWPjeO0vBqYwcWRW-xzFO8u2J4tU93ARj44IqfYg2m8Wfb3VNxUe3h1QDTdNwvAaZRyVViztPmeYJpBpVPjotFLb_srsLEbGM3r2bM0aleknAnTvXSEAlfsAAkod6Zu90sAMHYRh1sDLHQMWAwti8dQHiolnLwvNXNAA_Oq94HWUDQAcoIODboYogXMD_cdQYvBkZ8upj0BAHhNRj7FeDNuPQIKNosfxLg1echxPDqYOVMxxQQXkNowiVlUJTzzSh0RG5jhTIgr01LGRAwKqH4QAsISTq40rp7LeDDHRAwRIPCHciYzMNuNELNtyHuLBcb6ig6jNIYCFqBJIShibCio370giYhZ_RwyC_QjDHg0MdbQfX3jl4O2VOSYxOCon4LdqEyvMgmYgCjv_jxC4SH55X8QlH-LYMBD9Ri-e8fe2_NSDR47ux2PgMxvG48lTE8tLqc4wwRXqiFQzftpO5VoyfyBD1xCaTut6ALtWhOssy_w1xo01cskvkHwVOww2zjZZ2JQgP6ERbUAicK1rhv0SzfNy2AuUhAvWQSNvNBmEm4klcmdhhWSTQKgyS83uMHIAE7VMv8_JXVIGET_8D8BAucE3mF5xOV5mBfaTQHAb8GI6OVID8xh2D-pKHCfhOv094qyFOaN-IdzdbgidsalWgMCEl4kycNpvrixcdBwhm8abSAkj8jG9fa7v7Nhy4hYByilIl4DczTNspUjY0GdOgwTmrG0bgVAt7-2sMAPO222wD4weQGAAavYC4puLnq9c2BCsALVseAfA14HRWrdRDbljmTb1LaKUkiru1qaS4uqBmPBYbPX-YuJeRcNvEkxNowYHAY5h5IPao0U2GQ3wFJzCSEaVgkv5M8DtlYtM8-PA4BY3hZFHkKj4MWteNYJ-zk5GljQAL6kpPYDpOqk2QlDiX00iSgBRTjUGdAdvNjisg4JNyPKfJM0sKz_4I5kYZ2m1hxJ7L72hvdlJFinD5q6lIpo1VYMgUbKUkpDxkuPNuHOyKNYTJnqZBoOfN4nV5ueiWisUlMwjJiiMhhfGglkrCECpqg70XfDfwXwyNCWoSMD-Ok-4lMfH14ryCSt-IV1Fj4kVGEt3PjWsCbfdcdgNf1ni8BD75SaRVMBDLNmcxPNJ6KgA_8fmAQMPqJjXWbAe_f9EOIFLJAVGo8RwPe13syAJfAj0WKBfb87iPtlwKh8artbQBYciZzgwJk5rGhANySN44if4oAUYoVxavS6Aniy6OxqCnCFHhwm_K78ssX7nJoynGiMvHNz8RhmdMgRZBX-N3idyLHZIYG_QQ5pmgs-p00LJkATvD2nwEPwmZaAMsq6DGFD2-Wp_9eRuOE-Ss-56VqCv8q9SIF1ig1ysukeS7vHL8Yhtd__A718hT90pFsnvKPjIRlzuUzjUjDCh0a8UkIizS85IYBWnEWVw8Xrdy4LEReai7Pl5pjAjBRW8SyKDcFGaKkTP76InzhOF-sPmQBOkRVHdgK1mudgLi1ttKcgj8osKQ7jUpdQfPxOq2i03fCFKLtLACCWfnJQkQB9lpOVPQ9gr4j_fAMSq4VfQ_UZLWhgnzn6sBzBV4wfacUIePTkx1BTNWs60AMdBAqoScaQhrXlN9UdwbFGDKyljmZXOMwN4MySkQOXXcqI9dHwJBnlS6IxgRKwSy3wwDMgPEvTqL9lAotjwlikIBpNBEje1EDCjYsfLbxNI86QR4yCThuyJ9PfFhETy-Ls4DS34vhh3KxKSS8RcQ9_cTiwzSSBDSkFcVf75T6BHmC4WHVlc2PDy3pSUBVnp6HKjQyloqi6ahLj6KUOWQvS-4RFe6NSdmP1czTf8LH-c0yL9APPe_1vVnrjWGxy5AHNTyReEQ4n-STsDh4zCafUkhHSAIuJvVQUA8l3Hc7v3FlnpFcKNZPVdEjGh7UAdVZ8S92VLS7-Bf1Po4q6cHFheYMzs--PMq-PMq-PMq-PPqPvDwa2rdB9uVR9uWR38uj5CXNav2fvTxq2_357Muj7Muj7Muj7Mujmrw8Mk63hac55SaSfXeeextsf_7TfdrLo-0LR2ohNbl0ETxP6WgMA7UWVnUGHOf0ZO0JUtmg1uAcL93YHgD7vvuzADJj6nR8lvPNuvOg4LG8XdjyTsd0073NCJAwZSmG0uN7ngEJU42eWLge3ZThdVK0PLwa_Lpxl09Awi8mnQXy-9imgVAinliy2x2sQkLymvD-7Hul7Hulf-m9Uu92O76P90qdcjt9H--VHp4XTf9eKfRP");
    	// Vegeta
		registerPreset(2, "DMZF4:DtWWlsFVUUnulDwQYJICAoIiJbFKSsUiP0vUE2IRiwEYPRQMpipdDaSp03KKKmKhHEspVSWmRrKTtSQGRpX1nFFEQUkEVQECMiBpS4hB_emXPunTPndSqEH9akTZq-vDnfd8-99yzfmcZqWqymG3eI31hN0-repsWkm8Edgz4RHzLCCSPbZtrfWKGpGaMCmp4sTF4Uf1PE3xgNbFsFfwTbD-4Pgm2jbVPQNtlrG-q09ymwXVxU37Ete7dHE7R9ifH-NmoE2I5oXc-xjYw5eRVtxzPe3fVSwDbxgSLw4cnDLdE2hdlunlYLbLNbZtjfhBOefWaaA7K3jaAJlYKEv8IrNJno50PHhrXBX7FbtE312hqBr7aB7RB5Zq5tGrONzUlz3CxVbooTR9uXqW2S2TttZFsANRjRGhaYXlBoP7LkI6vMRaezldosCQFoKJwM3W2GshWhMswOlTq2rZkgPjlrlw_QgKZc0bzfwg6nDAudSLd2ddM04NM70bUFTcrDfeEYxSUDetbiOwGNj6yIikE9jp29Am1eF3YOC53wgDqzAFNBvnLlKgBllpcA6FJBIYK6MD-T2hXDkiLAAD0HQi4cKQ7kgcOpHUygOdOsF9J0YzRj259m0Ti5c396zYIGbaxycZlI092PJm9KF6ApWH4K9oIhRo7P3VRPpNGR5vk2BtBcci5K0BQVvwqbmvHnAaAZ3uokeCPiEWniFY2IiUQ7JuoD3_ylkxhfoeOooMHzI8msf8g2tQDy3Qwdnv21Dzqoyoae7YdWJ6vQyQ81gLBWea7PYmjluUIXOyByHW5p0Wf7lQAsb2GjafPjrLToc_yWVNvd16OJg7Z3CWvLEugmpD73X0_twKMDgQYD3ZL3TL2Zx2pAizMz6L7TwyEIa1rO9By29qRHzsLafztOCPSx7R_DklO6TAa0OFBEz2forevXsOM7XdqMHoBAq5ai5zL0TliAoL_pNZgHyQJ2USIxwfbIY-fhUkUCoW0esxUFBGyXQvCFI1BtPLexkIGwFrhpHYHWRzuens9A6uZEFUOTAmaiqg422zC6R7uuvkiBxIdM-4PIz352ftbyq9kbMq_DfcEjkeZrGy9hJ42PTLuKgxPpHVfTDkrhHUZfw86hs2ITTWPG3eVFG13bFSM6plI0db0EaAhabAbRAbWFOlrMuCSt9oNxzo84j8FV9jDeP8M7sX-SvUJ7I63VbW_afj_hI7sFhqBHdFT4gdZBQwkbidc6cdBBvwiZuegEtz3EbFXXmJaf7tUYbj5oX7IwwCpKBNo7C3vDnjCA3XoVUh1QO8JoBrWoy1JFtmHZNSxpYxmq52hHWTygVJEySdBgOSHeyLIXUh1QO6Zo6mj6RO32PpMyXkmdYEvhp2uk8H8shUVAVD8p7OrI6iCFbXV381JYXMtNS2EbXSOFfaSw602NFK6RwjVSuEYK10jhW5DCRFHcuBQOibJ8o1I4pDrg_1cKq358S1LYUK2rCimcKKUw9rJTvd-ABYqGXabVSfDiI3obo5G3Frr3-4D7AF0ig_1Kv58A_fMTb3GpOoahsQ6ahkhGtvaJHRe4nBvL0Nf2bwE0JjdZ-9Ke5qwTauMYunRjI_T8-HBAwzcCjY8qGwokGluYaey8Poaht2_4zm9MkGjsXKZx6Fx7QO_u9j2gy0sG-A0OEo0mprEHDisse0RYziquExH38Mczmo9g9DGN846AEjR5y1YAGls2Ve1yygggGtSrQF_85S9aSaILiCd-JjCaZSv6AM3Zzy5SgUecICJ9IkNLaeFuAWYegc6WEl_1ZTWkBFAKXHESye1hVb2vP1G7x80PKUecDBALgH64gSFF7Cnr3uXsYKfmHquOL-5duRRHI6vqacVVSZ29t1HJtCJaLIBEoWPTigyAQpwPjJmOnldimIpCDDEroqJQTStRtQDkrKCJdF3LphVZFAhNd-ZN9NCjppU02cTl8bkRoKaVqNQ6CqmgWl04glrNUu8iCE08jQk6reCsYxr9U_d6D6lM1Qv5vsJNVTW2SLdQMJsG3AsdPCQ66ArGbIZejRHlHnEUmsjNWQy9DTLURIGguqBAbwJtTv8nNJuhv4jfwNBydJAKwZIFvbJBJqrmP7flnN8gg3FDyoMaZCTN5w6aXkf0ILNn02tcTM9jNGcSNjqZHmxj3AN8yc5cIPjgEXULja3SbtCvKXGOX1ud7tgKvl9B2pP2crnvJi7K5zOaPwYOBZr3LuwCmqv73mZRJ9s0iZtcL02wqaOdCU2wCRYVRRNsjCFgJysbiKQ3P8hDyspKBm_ORd6kZ-M5kjyGPvzpIEDnVmQB-uDWu8EJdcR4rXQvCxkNDI2UBolJmano-Tqf4fMZDfZ2UvSgzgr0xrX9-NuHAoZGzwla7sV1Qu6F5NQiReMzc4GGTzIT5j3eFBaIv_iCV96XoaK2ZDWQCou2HiVL1Igii6grLKQ0ICJJZzT5Ua98lLpZIN-3utooptJ3FmIzmC9k8odHgmZuVE-rJuOYWAF9I62YzWVEIZFRqILFyppV38JdDHEEJrlKO_HZVbri6aC3tbtvGKr474Ws1RjBpJphgSfhuX5NQ78hLsCvX01fcP10bMrBN36VDHEBfgBKRUUPcfjahM6hRxlNthzilN7HHh8OqpTAb0j9UENcjHeI0_4B");
		// Trunks
		registerPreset(3, "DMZF4:K1aC3AV1RnePCQkpAhRbGgRI4pVDJBXkTjVu3czSlqYOGp8FAerjQSDwaQJ4u5SLJ0OduigpfLKgxAUlUZ5KCBiIyZ3QyiPJBSwgCBqi6NtxrZoh9G-e-75___s2XPv5ib3wgzDzt1zvv8___lf379kaFqGlmSks78ZmqYNv0RLrjcDOwuL2EOdWTJJ08IPVvA8f6i3A7N6esK_2MEcTUvRkqrYpkfYv9Xs32Qt6u56K7CipxdgNg4AM3fQMKEImJALUzkwDNt9foDd8_x2F5ESuGlgkzwaE6aysjK2SaoGDTOgSeYP-lAD2uYxAcPc5S7hLnagsbGJr-0Sa5NyPSKjLpkce8mU2EumepbQSeS1k8TavCGszR_C2oIhrC2UjVgeNuIouBRYy3bjA-2usI0c8Fy7JFPArFSuVOwe29ig7C7F3WGHxd2_wt0pkbsV2Q7tDrm7n_PbHaG5Q5p3uZqv8tN8UOde7X_uptjnXpPQudcmdO51CZ27IaH7bvQ_d0PsczcldO7mhM69PqFztyR03xsSOner0Jw9LAo_sIC_PRzwqeE9plMLe0znfcrC4kyQoCt48uW44cMplni5ct7AOPJ2N4knRTXogDDBnAjbaMkyjM_uJu9hBIxTKmBSBMxwLXlehZZ2TR7_w0w1y1NgmsEx3HMc8CkN0pKDsZccir3kcKzkXiKSu9YzhLW9Q1jbN4S1RySTJj2uDSt5on5hzYJwl3c3dXmjlDYgvWMs9CJHV_1e6UV2L0-N1eUNH1l9Mbq85H_PvRhdXtLMPQl0eeIsiXV5I2r2X4wuD-4l4S7vsnPXx9XlAUxPTx8P8eDu68_KF8R2L9WSeGTr7YfHc5iO--9djjDV3gSh_6TyBq5NiHkUwDwx5SOujdPePALw2iaNhryVsnANZIrRs69FvAVKMt657XZQq-y55zlw8PL2pwD4Z4RH-nWWlF3F8fQJ-qeI97iCJ44ZWNEKeG0pzVHPW2d3ujA1irU6QaSpt0BMmcF_XjvS69cBZiQvXnDumS8Qr1bBO_n2DlBrxqUbAe-Zrw558Tr3cpeX8PSfT7sC8X6k4K15Icjxbq196DqOZzATA96zV-ncWvRKPmadDMM2TeQwbNOdOfWw9u8Pz8a19RE0IdObrJyygsUxaIKzyNkVgyY4D7x5LgZNcPStWYOlCdLamDTBKe5_cLA0wWGmikYTmBHR7924NAq_1absPphTH0Ec4CYLCwtgN8Y5RTUL5g_H3oKbinBTEm6q5DFcYQaOlU8AdxLhuDh_BofpEO6Ji-3QgfMPAXDzUwUI_G1FGwLWMdRMHb3SCmx46f3wK6sDZVpOyrvtIKH6xtugdxv9i5sUz02arqg-Z6IBGn-24WUA3tz2JBwcQ8IO3DfhDMcjUbaTsa4W8YoF3uCJ13UFi6F_cmHiIF4BkRXjIV5uFMZDvNwMGg_xMmbU7I-feHW6lxkP8Vpa_3D8xEsK0TiIl5E97lT8xCs0df8d8RMvyVviIF5Sbm1O6NxxEC-DxXX8xMspvzA1fuIlVYO4iRdLwM6cDj8GtqL0yqEyMNb3sVR88agYS3XQTcicTCT7QXMyloE_5U1OVHK2ZFnVIMlZppecGaLS-ZIzN5_4kjNDBK4vOZNQYpIzI_eRC4MlZ9IBYpIzSc2-Iaw94m0BgqygwqblLXVy9WU9oai12jHFT6p4m8xKLOu5YPfT629VCNxs7idM9vgPn0GY4wrMzPGZSqP7yiuvAgyWWJvWSAVQO6HUZewAzfASgCkdd0rRBmu3bImTAkalqeVemqqP-Vuut6UuGfXTPi5Jz_rLP6C1WPudbG9vTa94N6sw2FTQXB9etQ966yx7nZf-6elgYitcfAHvkkdXKulZUFnCG4Y9UHAzb0OYST7m_Q3DG_bnSQADDx6mVKnAXPpZN8AsvHozqDUMspKlj17wA4AZWX2jYDYKpyWYrMlbvASpJPvCVBmmwtIPHc2BtILcySbhdueXnDSyjoz1cQrdJQnp_Q9yCaGML9cCtyMKpqdhaxZuAQAYjF1ndxVF8F7CQ7Wkg6duzQI8OK98H2SBAF69THrm-11MA3imaXx0sB8vBkgtXYzEFaWLfkzBGzH_K8BbfsUJUDSLN4oML4OHEMMDCwzMjQkvE9pglySLYQjaWCLJ5LUDkmQCRiUkHxgDIUkHl5rnSAtEYcsEDNEgsWU3JlN_XcKdK1BUeiWXoIs7S-H0hhUbdBg75BLfGkVC0uZRIGHuN19SJCTPmwP55XvcfRmw9kkXqP7eyWvUuVWtX9TvffUDJbzIJoIC0S_RGDXh4XldRl1ScMfdgAdqsfz33567YlLriDu7d8wLgDeFpzKGh1Z3mZQuwgu1sOmm7fC9KoQ8VRDyr0Hq_i3fXWF24FWZxr-AmVn0ikUyf2Ct0abPV8Nh9hX9EUShAeVeO9d7mECocJv3Fo3G3mUgASclFgm3wm0zSGjnVJRJuCEFWosQqyTKOIAk7Mm7DCSsbDwJEj5_bStIeIs_MD_BAmcHXuP5hAGP_U8jALNXyhCBgN_g4ymW3chPjHLMn4EdkFqtd_A6ra4iGqjhK7tzovEN8MR9I6uVGQRJeIcnDaZ6a-tpkNCPN40WkPJnYPd2C_IJVkE73AoqAwsCfvv1PwBw8wffB-Bt3JcYMMiUjY0GtOkwdoiFlTLdIODuN34MwMvuuQeAFzm7ABi8grmkmEZ17LwcyDhesBTtYhRCwDuoWO2A2DbD7bZ3vOGOzbbnmoqLi-FIhAXmNGzylhJyLosmFdI0FByGuQcO2-wQa4SUSUqE38FYVEyeJb9zJylkYxq7RJukEDCGl0mRJ01S0KJWJ9YJK9ysgwT0JTvUDVNV22ElDiVMUySgBSTjUGdAdos2qyHjkPBosxqS8Lvi1xXP_ivmRHzFrI6DJztw6Kbveoc2knGK5dQlD222YMkk3iKNhSLGv8Kz3TmrGOOQxpugNJmkhGmcTpsGeC-qBc1p4TZmEnCXHSKHMX7Z9qQy6iEJz1NBEwNr0Xcv5amL4dEIVoRMp-i-xPBH9RM38RXzXkEkb8krqLGQhyqrFLwDu7cD3uoH7gc8Rp0AD16xREptIiUCN81J3H-1Anz0NzP9gNFPLKzbDLjvra9DpJAFgq7GaxTg3ulLALiaX71sgcNvnlNm40LjLd3jAJgdRpkvRQTIilP3AXA2bxxF_hQBIhUrilep0ROjpwiNRU0RpsCDW5Tf3VaXdtnEcuygm_ga_CJvenoLSFgGKYK8Itot6tTsSxm6MSawyNCgHwtp6seExqLfkUK6yQ84xNt_BlyGzbQAdqtghCncHlXMu1LVL0REJ4wfcp4Xrin8VXj8AWukGuV6xXq_y_uCXwzDm0Gf-eDyJP06qUrr4ruImIlFlP-8p9cD3lrOaUQaZniYj91wkBLCBgXP2VWqFGdx9XDR0o27hci98VaBF21uxgRgojaD_Xs_8d6Uns0LXHW9-_FW-MJpvliagOF4VFZd02BkFToDcWs6R-ibJYwXKiwKcstBoXZgGm9qpIokDTvU2RpJEJTN2MP9jkkog6RrURKXqurkrDQvJXIuZKVFm7YxCXhOKR-L3ojyp9t0QU70dOkpwiZi2nZbfl5-vmfa5hYq_U9nJ4KYjStvBjHQZbBwwbmQ1DSS_tKXxgN-cbiNf69hwEvIfd7lCUOiG4HjN3_s9SOJ3R5UgCEXS50SUQlK0yz_A0lmwPiLHbp6aZOS68Q8kICJvgha7353x-Jo6c_yyGR3mkNNHlISO4T3ZAfdCephv34X-YLEAQRBonxtCAn4yg5u4vcgJwExhCQJaEgziN_YpBoGuYThYWV2GySJmPf6JamNEX2R8ELmA15FQziwkoH7_BSl7OL2u-QeQeHemLilLyFi8pmqfthGjmca_wPnsgLv3TJL6Z9hsceQxxQ8kZwE0zzL2bI4OAtw9ClpMAk50zNtPe7XZwn37ab_lkGcx52XYo2VFT2h4EGtkJ0Vf7GCoiXGX-T7OCmlB2leqv0f");
		// Gohan
		registerPreset(4, "DMZF4:DtWXtwVOUVv5vEEMI7ggVL5SEIKo-8xOCU7t27RWhhYArxUTpY7BogGgQJ4r2XQik2bWlTDe9HCAGipakQlJdQhGQ3xPK2gBWFYm1xsGUoVTuM2FLbc79zzne__TZr7NTp9I8447CT_c7vfN95_s7ZTMPINAJWW_g_0zCM9jcYKaV2cOPmzvBhth3ONwzvL06wqr_l_cWNFp37MNUIFMPZR-DfEvg3xUAhOqIIHcidJ4Qa_vbwJBIqalGo9o4u3gc3OC9nlJA294_ZQ9JTNekNt83VpOnmbmjoq-NJaFqLQkt6l-r3nK4JrX_-d5oQ_cU1faHizywU7bpvAQk92qLQs9Vn9Tc99ulmBAU_u3aEzpZoZ5_7Rbh5ozn1D96_GKW_frI3Sc_QpBNDY3mfzXg9X-jxFoXK1_8chXYvTiOhmVIIonGCF40ZQsjziriedxY-RNxodMa3hXTsvfJqlA4MUlWCUF_zPdS06OYnUKhpyDtCqDHlehEJDY4X8oIbhZ6ubKdaBKIRL6zoVmCGxD1XUVl23314zwPy7FA6m4oqPZ_Gq4xWLshFlT-9pb128xsvDCSYbO25Pxp2kwqjSssLp23NIukc7d3gOfXmzT63-9WhJJ2reXeKSCgZqCA9qV9HXSiPhAKedws973YSuq2VJXcKTTGj5kk0linvWaFqithfmTXlNrQa2YhDF-65e-B5DN2_9-tI0kuajUI4W7HmDGqq67aJzi5T3QJnF4jSBU_B6Aahcy9fQKFZ3ikhtFwTeuWlP6iGAKH9L7yNt4ILk9CKOCGud_D-nif24tmFpQ_T2ZXq2YgdrcFMsL3yER81se493xQwB8hGrgkZQDCr4lS6VC1AZQaWQjdWPGIsnV2tXW-reEHEDfX45xo97tdoZ7HeA26Xn9yNuONy59HZtdrZZ3qZaKKL14vwbN6AWjpbqdm1T4cCFHpxaxa-YOnGDroH18kAw7PHC-ZjPmFwg6YL97yLQlfGTyShKk0Thj1Ix3aOVqXVjOALN6ZPrieY9drjqMUo3TJQLa8HH-Z6UQl5cK-XB6Km2bHRWLnt2NWsNogCCYyqF5BdZZBb33FXacGNFgGcwbu-izj7sBI4bCwnBIGlmk8JltiPLzZSGQ5owCs2heIv2BgYsweBqUM7VKEBGDupAqzwhZT4ZPbxOgghwBssXg6xtloEs1oKjFQpnWGkTIsYbW7NFv-BFcdyr4i4Vg8RKmAh6WPjcJxe1yr4-BOdVxzRjtDVXGsRFxPjqHYkfeQucSTcbdlv6chx7UjO3OuIco0T2jihHUn5wV36kdc0-w_otEHNLjAy5bwb7vXyBRI6pQX_N8gPMfkSiAY6e1qxZOBxIz38ZOmcmTM8GjixlQa20sD_Vxpo7Xzzgf-YBkbxbHM0MPZs7VOfAw2MAX9pgQY2fG_q7Xi2rKz4v6CB45Zu1JteKw1spYGtNLCVBn4KDTTRWD4NtDJXzUpGAyF8PisNjG2ecOXzpIGx019dpNJAMPplsrXPB2XNbuWD_wM-WMh8sLNQbXb76yDhM7Oqvgc28s7fPyEUmFl_-dj7yqlf-eXuwnlBbpn8leuVbY0zpuGbzIzigwI4lOWuQuCMjiUI3FbURQguWui45g3TK8QTPA0anWS8dJEggLe57zlsL-_eORLx0v98B8Lgh9luvQ8zVYPpdLkJYeYgt7HDkOsI00X0Q4DpSH2rITyul8Y0GSZr8BaEoQZuh6EfqjARxzwi6gvEPJV0l5W7DR9dGKjH53RNQ9tLD2FnyPxoZXxnMNvUPoX2I2rgkrGhcOVzB5OMlfHoWsrD06iK0HtVf7AFguR61wRVGqtNcAxltG29c_gSOUZ8JR2DFtUd_ZiG1-7Ra4i3-KY38KJZmBWOmfnLFxAPLRBxzX1Hb9E9XqLhtRdhAhFOlM0Op4gy7wWisDG0WJqr2ZBQj1PnrMDy1GVSP40vMzBdQokBqBPqw8H1wNWTWMBv4pJTMzBmAwAHy6u1nEwTDD_iBPNHf0loMKXPUgfUYmWlgFEL9ExNQwD5kh0q-uLzmoaUaZORknN7NI2LjXj1t87cqjP7WcmynuiRkl5sE0m8-S9qcD2h4dF7fX4Yzh0_EfHwWlArPzk2QRYjHPZ8085O5rP7u21CvCGilAEeWd2pP1XYF00r04tu4bKn1RmsVGrg2aYDFvVfC-mIXU-usq1_vL4PSzd9BZksPkD_rvlgOT7mYP4fURXzy9jwSw9pgxA9JhjNq4v3orXmeBlqaDAC-BiOkyhNI25wn2jtoOH21Ep8zElub3JqYg17sm9EDcSrbeuDF7eihr3iA8RJrYABYKRwCp-MwlfaHMXAu8TEBtWN48QqpPoZ3I6l1WGi4TTSaOnyV25Df-tmjMSDHUu06Ys1EGO1Q9U4Y9vWJfI0WUCpn8Hd2xysJ9QF1VkjWwPGUQCAK9_-JgLXiVjytyKKscmACmuSo7Qc1Ri4SdA7AKafGGxrbmwnAmNUQEjuxz2dG6zf0VUAs4NVQpqrAW_nZrUdc9u2yoUQAO_Iy49v7cFtg2wtxOWAl2CByatr4lsJB5djUplzou-z8zBgIDxGCbYDGoALkob8ZHFHtNgOywUlx50_v7ONg5S46kh2lwZM6WVz5tlsUYct6vBo78TmlxWjBp5-_EUDtDjSMEzTQBZQjMPMgO3mV5hYKlYE3zhyr-DXxECBpuE3w1_SIvsK1UT6CqxOOxI3eOTur2GcNGOc4WrpKvRJYXALtcxQbyLyocs8PcklxEKsMH5kh_wArNBuXIOtyeZL2NbZNsMQ7zm9ocWqhI1BA0m5UQ4Yy1_vLNE0bOSGxr2Yy5ITXChKF-DxXCpTpkGyr8DSJHHiF77hgivI4q1EBRMLdbxfpuEd2r0N8ZZ_60HEG_TIVcTDr6CQMk3kQuCXOQviRFtMMPDJX41JBkxx4lDfBuATe7-AmcIWCPk3XqEB45ANwCW4z1MscBT3JU6DrEbyxluaeiKw3ILKTUdCgpTj8s-2cMHhbxk4QZRmxfmqED25-0i4sewp0hT0cIfru091WcrlKccN-YVvdbLMK2hbhRrKsERwVDTnRZPJvlKh17QILCu0tuxQbiz5jpLSa5MB07LPtsYRmZbAfhdMMIWyaKrUgHfU3Rs_TniLC-op4ivAozNKj_KjYl0y530oHAN4o2a-qjpPuV8Dd2l_QS_XPQntP_uH69RtpCzDgEf12E8HpSCs1_Bwa6Q2Z-l6dLTicb8RJS6J0ppdEoECKtR26NL-i5qnsEKUlAbLjx3XYuGsOAw1sjf_OoC_JKhXx5UtcC3ac9qNPKcEH8BZ2omVcavL6zpTxWlubSRNIWlnnqjUgLeZJlM58jLXUn9CSNHuR29Qaq3kPdiTVUKF9S6OgadKPLk2GpmTnZPDa6P28U3I_NP5_qhmQ8U9qAYZhLrtkoSQxzW_uxmHkuVYHf2-Y83n0HhdmEEZJYKnxaZSiRFlcj2sAWOdVVgQjwlcgqG24wAMwPQXN9pn4VqtjsndFwPzaCJH9nA7TjZqfI75jMg6CI3eTOBo3PCX7KHf9xihrc4SuCzNAgq_l8MP12JLaqCv3BBtw9Vf4I5pGsiQdujQ-1O0_oR1AvCo6_rkRxm6jycrQBsSOA93aP4Ryb9olJZRKvCJZBflyuFzWQ6PkAxvKspq-r2m4Z15ZTvi0fxmW__iX4jeGjFW48Z4OM6QpzQ8WXhkOp8Xk7B8eMThmHJCJ7FyuLxFd0Oy98ilYwKHkuHbJDyuzDNsY7Zo3EXf0PCwD6jBSn_hnw8lw4nzxxmlPCi7UOPf");
		// Krillin
		registerPreset(5, "DMZ4:42JgYGZgLGNgYGDiYGBKT2ZgVzYAAw4GxjwGNufS4pL8XAYA");
		// Trunks (Large)
		registerPreset(6, "DMZF4:vVoLkBXFFZ23u_JZEGERAkQRYUFB_rtBoIT3ZraUTaCggiiGFAaysLC4fGQRZ4aAmBQmJGiQ7374o0GUj3wkGER2Hp_wWVBAAUGERIsklCGIRUn-6el7b3dPz3u8XZaKVRZT-9493X27-95zzrxMw8g0IlZ99n-mYRgN7zDSSuzotpxc9jDVzutkGP6DY17lDyVudFBVlf8X12xjGOlGpIgFjWH_FrN_04yE0SVOdF7VUYBZdROYsdWG8UIwnoQpvDkMi756k-hxyaJzaRIYlCAl3vGFHyPM-JQwhYWFSVJS-fNezRGmqNow4ZSY3Q4MQZgJ1V5UODfmhZb9EOYZFabAjreZ31eD-X2v5v5Hjnn_7HL_wTWj81bqi5qIMOkIk1m3lwazL_ePHMbr_tIyPq3oU0_O5Xje_LLTHC-2e-BOxJsUxPP2d72o4S1vb3E8q8s7P4FprR09AqOf1aIv776kRa_qMJ1Hx_P5X9gk2HcweqqIZjdoqH-D6kHQrJ4zII9lZeV8wnvFGYt0DmxHwq90Sf2Vrqm_0i3wFSea3ahY_W6BG1u-pyUEdRJB3dWEsKBHWmRqQRv236MH9dCCRvKMpwjqqQXBkUsRlINBGX7Gh_kZbwyHGoIYDD5IGKsN3Hw3r6GAma9dCRHdsqxUi87HaP_CY_SrgZkHorWx4xTtyegFyaJDM4_TzPfKmS9MNvNqrXtR8nWXp1734lqte0mt1r20VusurdV-lyVfd2nqdZfXat0VtVr3slqte3mt9ntFrda9UsycPUz3H9iFf8y_8Bm8UleOHpHNK_XeLv0GAW7BA-t5paaPnD3QN9hIi9eYULtb_rsMVrljbgaOUAfnV_HaG9CRpsBs7Pin1ANEtmb0GAA4NGNLcodIwlzfBK-A0x8tbUaaBjO5sw0Lrsu7K1twx3PXAKaoUxNYcN7g-_iC_TYLE8VcuGbv-sthBNnI08XC6xlp4wqMuu268_9YggeJHubvTgUcp-xDlzHyYJKmo3zlUOqvHE79lSNa6wr1hspX3v0WBIneYFSJ3gBBo3jnVoNeKOyoBx3VulC0Zb_UIx3TgkKdNVHQByKonhGZZNTJe65k2uSJPv9-nPh3Y5WgMTZy6V9j-ZZbX729MSHrLHDfnzKqA5zEzKVTNEaebgTx4q3--ndgN5GBO2-Bmofwmk64kQSvWhw9hIdVxM5Lg4WHCCnL7DefP8jx4q0vvKyx9hCe4JatXv80FX23JN74JHjeBWcM4DU63iYVj4-FeXwI78OS0YDXlC_qpoQ-1jb2J43Qh_CuvFAIeC2ud0vF7OPpH-3SmD3hVVUd43jmjgfPq9vKomcbEeBmu4605jB-jUWY4loIhKiEuS0CQREck5KtDse2zfXpFQmXyWBk0idrdbkSMmETibbNf2Q3Cl6CqOg_hGeOPXcN8aYEs1Vd3QJndc6colQCJgskSBIBA0egqN-gkJKBgtOeN0wW_f02JZCJr4VmKhEzJ9WDvsHGtz6DoDfffAvWDQ9s5rQv8enx7ZoOon157Y08iMYHN7qWmtjI0rUQHduYpUkkisYhnei69c9DNDyw6JUrz0J0zgPrNfVE0ZAjkXOlkpsD7loF0T_NbqQJK4ouXfscRJfDCVCiBy9YDdHLu15MqLCUaCAgajTdjnh85J6EUsvGHLFofHCjq9c1hugXF34M0eK0aJrLjq6guogPLj6wQ5I-bTFEb2q2JiS-IDonpydEo6NAVUZlG5FcDIpgUCGvKQV29MSwtnBvGBUDGGBXKm_DL7vewaujALhiVk8E_o52IQk4hmzI9k0CdXUFzh4c0_GLH4xQ_NCjwH-b_PJhrW5HemtTB1nLZvzlit-oh40t_OUbhwFveNtzHI-GcuOiL0f6CLyai1frRsnoGotXb96Z4RC9buiVGotXefwWZh6_dfGqHP1bEK8-9amxeK08zPszi95-ZniNxavZMR2Yb3zV_L41Fq_etPvXQfT1rLr_Z_Hqjf3267BuuWPVF69y3fPy762FeK0jilX1xau3iV9RNvNh17vVWLx6i374FET_4tLeGotX88lma_RCuaJW666-eG0HciOBePX5fFC8mtruJhSv_Zf158ieYCO3SbwyeqzisZo3luvQ26diUTM58c5jrgdVrJf5zRLtRqZUschJoBsmYhUelTdripj2wWp3do94gTW45wxN-4ail_KmkKhIWIIPCVlM0UhFHIJJdNwlgTuiRS_iA7DoBavv1KLJEpBFQpPOdvRVzvrU6F-1bgjEX5TWnX22aBqaosvp6MHJTdiQBKvQxDQd5UTR0dz8eyG67OickKqG1sz4AUTPXT5VJROMewvqYJzQTiccQcYYvuYEm0W_BNfIMY9zEsUmMYIvKqATT2owA3mOVEEBrJTBIGNw6TuqXD-l0Qyk3DZVACeaf88ZbTZIRVyrz-WnEea0gNH9hWFBfyHW7G-dg9Ilr_GLx_hIsSzuEDCmtOSRFkENQx-5_aeM6qAZDbjxsXpF-0BaZblLAbgeOCNOrD6k2PEVFeDdMX6-Lv3Ganh1kNKZ6_gFYin5gtM1hlfnL50ABh4CQrRQg7nry_0Ag7fOzmOlGmCaTPwRwDQqfgioA2OPmq1AMFldNgAMknopsxGmwKHb4Xh375oFwDi4NC6Ud1fjtRHqX34aVBzWO5tgnFhdZJrC4sNks76TK8pXkYaH01IWnrExC_Bgvep-UAaiuPWqgzEh2caUwsm0rYuHLuPGgGdAGwMZ1Tf6GQ2vATeSGN7c5qeC8jWWiVoSM3Bz64HwGgKrt2Po-JGj5B9EnmPWZXZVNFATqUqeJiOyNTOCgHESyhloBleSFq5ogXAGFA9nkgYMt0FxJeSdzOCdq8Ch8ufExJ6lk0KmBulJg2GyNkIEdKFNNEIZIW3cSKgv3wNfy40Zl_bC1D853U41zFXnInTrd3P9r14vyolQdPQX9XA9q-Hheu3-aG3aeT2HPA54MC1W__5TNVQUI92pmZpsz5Dn2XldeSljeJh1KQxj4nrhLKSE9_dVc0AyhANyJ5RuNLjsPbhVtvVPEJrS-4ohA3KstV8tgsWgn-VSAt24qOrCJaHe6uVsCu6i3wthBHSkHBrc8bodGAIj7ELqJyi-_LGCcFJohJ3dm8II6NmQ-8xGeJdsaGxwbvRtXk8YML1Y8dhHmslCwO9wh4tVNzonPtcH4K1QWh1ys529ueRX4kduZXurFZzEfY2KNSOGRnifFw02dbR8bOsy7jRmQH1FsmOzE3wL7lNmzaMh4Pe2_AGAKz77AQBv4meJAcOYarIxgdKa99i10uwbAt4P1p5tznniCQBmhFB1OdmRRBvDje7Zdjd4C8SD5G0Xzg4Bb6VmtRXutm3N40GKWyPtyc2cnatHPOT1iAygFydbCR0uh4wXxWyGA6O4aB4jQpoxFDp34DqrbxXo3EljiHJMLlIiY4iA8XrZdPMUYwgz6tCbISc-c04RjIBnySVj1o1fpNdTkV7aCJgBJTnCgMe8JbKeKDnitVQC64lG-LDPFu1kX8GaiB-xrKOP5kYPP_zdoAelJKdPsh9QbMCWSWpOcbl-hp1SuP_iZEs_W7hSGQFjkpVC8vmss9zIF1JMaWi-RaSJMyGvfr3-ec25ohFWU0OjXix592xeuhjeK_fFglemUrAv4WXp50QWvj6cK4jirZwKIhauN1v4cgs1vIM7NgMeyjXbQmHr4EeskBJNpEIgy5wl3s8I44uAj_9uYDJgPCcO9m0GfIyrakU8mXLGizXgo71nAnAx33o1A0d--znUT1GNxIzpZzr-YjS7LHRBUP_ZVgtOHEX9FBdEaVZ0XxWiJ5y00IxFTxGpwIU7VN8l1aUol1SOa8rCV5rs5qFstv2XL-qpSLSLMSL7SoUuSwksKjTMj11p4mNixoLvKFe6PBmwx-k_Ax5M74IIWHbBUCokRxX2HQFv2_RYUE5YP-Y6z-8p_COGh99RepQ8FcuSbd41vjEMb8DkA-rmKfOrpC4dEy-ihMUXav_4XtC2lnBNI8oww8N6LK-DUhBWaHjx7flacxZbDxut7LhsRHLHVwq8RDYgGwALtW3SWzuxU7EWvMEVl8g36uIsnOVfVnw8D37rqU7dMPB94Dm4t3b8A3rFDPZCgUOX3IkPpl8r9uKkRulIitmhO4Q0gpBsviEEIwyGoutQEVe6apesukFJJF3ykGeI61TqseBGVD8l6YKaGGDp6SInwiF8tEf3Hj00h5AaVezP59vDMKv4i2s2DLAMdl3QF1JII81feaN7MNk9RG_btmbS8fmIFwxFbkRP9v0ieI4UdXtIA4ZarDAlkhJUpln9B5HMgPEvrgfv3NVaJyxHAib5ImR9XgO6kPTOPSZc2jZE8lCSyJfvyo-GjyTju6gXFA0gBBLVa0uMgB_JF-CyCISsS0ykbeIrQ6WHQS1heNiZJUFShPnRZEVqVYgXiVMITrgyUQ8NKxX4WLKJUnWRfJeOhymONxZuuuqq80l4p9_bCnio8Wzrv3C4nOgn_CdyKn-GLwcSeULDE8VJKM3zXC2LhbMLjmdKMSahZgbc1pPJeJY4vvv5jiuaR_ql2GPViZ7S8KBXqIcV_-KYghLjX9T9OK2UB8UvNf4H");
        // Gohan DBS
        registerPreset(7, "DMZF4:rVp7dFTlEb-bhEfCQ4hAwVIEFB-IkBBKg63s3bsHscXiOYqPwqEVI0I0GEgQ770tFvWg5RQtIhAgPEXFIA8FodKI2d0QyjMtQglCEVqptRxr1R6O2vfcb2a-79svew0p_sFhz-43v5k73zx-Mzd5lpVnRZxc-JdnWVb7NlZWpRudv-ol-FDhxobsuTX4xov-vE_H4Bs_-CbbipTC2TL4vwz-z7JQaFG_9ULI_vuk8eJs3d13zqOz0_SzJa79zM6vibOJ_vafg2_8RLvhPYRQslvtoyT0kC4kjYEj1Y8OpSPlhg0vXXMKz-6YlxN840fv6n8SDYdvSGi6IfTCy3EUAtUo9GzfShT63uG-JDTDEKp-4WUUqsmuRqGf9T6O5ilNFYZQFRqjaaJv_OTpXjeSUKUUglu5LbiVNii9ZZCLlzFGXAZIH_jle8J7ybEL1wqY1L1-FcJEBhNMNumuGdhV6E4efu53wQcvsWvMGwiz_1vfNRwbKTAsX7u-C559dVO-8ZSRYcbZxy-bgXaCmfpTgp17P74H7cw-WkvSxYadZdeN0kMOpPG5QXrRhLtNO0fozhoXOCsXYbYPPoMwYy-3EQZvrMSPzb3jDhNmoWFE05tbUXrx8zGUPlQ8G43YcHYCxsbuzmUkvdiQxmsB6VLhc5Cu29YNdU9cug4dUHR1DUlXGdLJos0YJBB8CPPkipHixmJgMOKdquuF1szEpPMdhbc0Hc_OmjIR8SDEEA99U-EFCYp4f3IuQ_t2vfKuwIvK3I0sM-z7aNR2hFm67mGUPpP4Pkp_Uf8BehZijKSXG9KbhAL9Onae-yE-wujyPSS0woio09FtqJIKk5cawPfy2xGvoScew7D2U31OP00wqwwYeS8ytNZcNQuNWEc1KzXu_BCSXi0thw-zAhgIsZuCEMsRRSyWnPYjdOw_ruwsUOqWfKenQLEhtdIrXnLzi78Xh-s7lO9BI_p1KhZSI6ffc5VZ-iLp0rF-c5ajqg-FA0r8KKtSrrayDKFzu94XQs4I9LCXZOkE1V8_CdWLpLOldHsra0qJ1e6KglGFBYWF8NC3aEVo4dpOaP7ALkfRh09Ud0AfcmY40wOnCdB9-u3DkQaMPN_pOv5KOtJoXBIp8KnkgNC8HsfMfnIkTcin4gZn7-z-vH4DwdljhoIop0HBpd_Wyz1Ic4EJbpSkm-QTtLciD1lt4w9XziyfFjTN27lpdkRcqoxanm3Y8AoqoLakN6GphlVcnrmfeNH1NY-g9Lqra8zeW2pI0xE38CtKY1MD6VUYeHp0PWBILxfxq7qmR8kpszQtUB7M2BpAN1w7Sq8c4KA0VogLYg3O48IIkJYBwF04jEeA9DOiuGuEQhmBpQJg6MyFUAxngqgQF0Qx2OBWUQxKxdZRjKC2t5piOGOH_virpBhvcZWKTT756UVQDNUZWqQYQZFvNcWQ1TRlb8pvNcWQT_mlFCOvJYoRfXtcf4RRzspMMaBMR-evxuybUzkphHTIam8_NbzHl5IOwOv172UCL0rdPQMNScTHXo72yei7KBpSN-zmb2BwwDN8BTTE5lSNyVQNoSGQ-h-cGpBGqjMQE9mYVSlpRkzwecF_k7_-IsLUFo5GmJ2vbjJJUbURkM1oTR2HQJCI_z-tSUwSBV0vWiG0Rg5emfiN4hiys0l-k9V6fkPct7X8RiZDK_hNSjGFMH7Dg2EGfqPo3MXzG3Wjkmub_Caa4UiL_EY-qtOz9_EW-E3yWsEO4Kysja3gN9ItmnQ4vxnH_KYLJnD3vw3ChFspsr7CjXd5rFFosvP_-kXwk8cB4nHt8fknEQWk8j5SmUOVoX3pbrzQfL8Kgdt3LkPgXOwoHu0JAK_N1AVGLlqTDby2okMD3nruhWep4Ntt_zIQYfBDGre434C55MMGhKEZy423nViHMF1FZgBM57LrZEElmCkGTP71GxGGZnQ33vP8EB2mxLP3ixILAcx7AVbuJz577xqT0E41NOQKTgE5mPfZEuy_XAntdoJDgv-eEgUVgNHZFX79MEnSSw08Mkt78BzRkQEPn1e_D_ZAhhYleWazi1mKPMZ1zuw7RxcjfpIXo7Uo7aIfNPA6PPA54tGE4MbzkfR4dh5Rb_IAtJTaA33MGy8z8DqKMIEI_-n91yJe1r8mUyDSCJWqFdVAOhJSMnvmYrNSTTOAyQgtBroLhiQfHK7-6c_3h3jABmcbfJWBMRs0EqFyMkdQzhIvSr3Zs-WdZQs-CfMOBYxemcsNDRGsUtwWdQ3U0T1mCL5tvV-Ppr_TdEUYJW6W9bRy0NKLfSKJAX-jB9cMA4-e1-V248aH3no74qFZUAj_c_C29JaUUK6tCLszGind-GBRygCPvO5xR_BsmV5khc837Qf3arDuHMm6O2HF_rWQLnGZRrnOP4_WYg2nnzxmRJ6z7pNF-DC7h_0xfWeTguGCevug9IcxyQ1oWHZoLmpIWBF8GI6TJC19fSJAoIG7jsberzc0vFFwKWpYsKwJNXwiWBNoIPrkqVUpMnwAJq6qjZdyqGBgZIlQ3ThOnHFUP6NbsbR6zNq9oKihBvrJTwwQlDJtXTfE0PCWKBpg-urVJ1DDObpp8oBWP6M7tnhYT6gL6oyqwAB-87U_IHD1uz9A4M0ilgAYderOJgdqI4ji5oUGcMP2nyAwrTJdZ1bqdQTGqICQlKMXk35J0rWhZKgBvJWb1VZi6858IQTA24qGpbd2Gpr0EI8UhXmA9p6qlXBweTaVOS_5MV8eBgyEx-hL1qAGIHbGJNgs7nbQXB6P4IOruFPzBftYzWdqzPumAUzp5XLmuexRjz3qJahPeKnZc0tRA8WSn-RNVwpaHGkYbmggD2jOYWbAflMVJliYpzuHleszYbGhgaYILbI_oppIP4HX5ZsSHNE1npthBs6RMzCSwuhGapmxvpalM3jQ8AR1yugcrDAZVwgLDItxkQWlkIxwnRPthusbLa2hpVbiAM4bMvA6B4zzi5pHSMOzhoa13NC4F6uN2xxRurSVkUyZhGRfco4340QVPtrxcPHWooKJhZ9Uc_JzBt7eHVsQj5aRrjPovvOIhz9BIZWvj6gQqDLnqBcriwzgw78aEwZMceJR3wbgRjEpQKZkmOwXG8C0pXBjZfTaUHmARlNtESQt3tjQ2xzxl4QlyPzjdyFwT0EcZf2UCaI1K7k70Gb9qjCLZU-RrqAH97i-K6ortzFqDFaFb2lY5hXnrkQNc7FEcFRkukWbyb5WoZe1CCwrNNoHKc18TFo8MsNaa3kYMI_9vEFUwKoLNnOF4qhyNcLA2zbflD5OOPeKOS_oKeInwKMzWo9SUbEi7PI-FRcDeKN55YCXp9mX4C4d7EYIb2VY-y94cgXiLREzjSzDgEf1WKWDVhBWGXip1282mrO8erxo7cYzLQpXS7xMexlQQIVae8EjbworRFlldP7BQ0YsnBCHoUZSpfaTuJTXTR-Pix43eZJWSvU8p_CS20vN5VZX1K1cx2m21tFdIWknrbL57YY28jLX0jfiWYZ99AxarZW8B3uyTqiw3qUx8GyJl3kH1DG9CcnVorNmwQ2oBhkEpALt2jRCyOOa6m7W3rAc422ZM5tD46hwgzZKRI_ccDY9RrTJdZ8BLJe_zIJ4TOASDLUdB2D9rwZo66bVMWu_AcyjiRzZ43K_R43P43cvXqovEzgaN_wk3ZMfU-8eDoRxWd5bK34vhx-uxY7UQD-pF7cqwa2DhgZypBujvz7Q-hPWCcCjrqvIjzZ0HworQGuacR7u0EE6pxuapGWUDtwYZihXDsVlOTxiMrypKOvp9xsDT75ioPnNdf6LweVF37nxFoMb4-E0R75t4MnCI9P5lJiE5YOXeBxTXgzfAQEwFgGIAfVO7UgYh5Lh2yBuXJtn2Mfs0TRDjxl4jfQ2UAUrfeOpPwyib_T7aNLKg7YLtf4H");
        // Raditz
        registerPreset(8, "DMZ4:hZh7cA1XHMf3JhES6pGitFrxaj2CvKpiqrt7Mx4tw4yiqkNpBNF4NFF2t6XpdNKOmVSDCBERmmqaIghSGuTuJUqINl7xKNUy2ma0RcfQVh_nnt_vnD33sNO_7s6eez-_c36P7-93bqSiRCgeb6SiKK2bKCGZhtbutxjykGJoRdUdyUOGkdz63eOBJVOL-uWPwJJZnf9sh8CSqU4YvySwZLEl67l5U54MVTxphDeNfKaTzzAFwM3SDlKwHmWtAnCzlukAjujdhvJ8XbUfgddkZm7gjRWwgLxUiRfe8yLwSrteoDzv1T5DgBf-c2_AwEOGVe1gpkuYVtdrADO_SylsK3xSNWDazH4VMC3T-9DT-ZJHdUbMDAkT1XczYEYt3wCYDrf7i5gUU6utj6bHtNtWLQYwGrd8d670pBvV9o3YjRZmShYiGidTC3bknXxqgWFMrWnZQvDfBwPaAxicnWEdSFQU5KVJPNyWcPCwLVHAg_OK8WAeUDH0lkZMIXiWW2BWdzoLgbl8pBEDQ5d4YMCjcqBfl3jNZ90F3pL2Z2CjUfFvAS_y803AAw-kWFrV0SfkiKdLvBY0TUiGvzO9F_BC7qViIlIfZ5j-qsLmoiNTLDt0_koK9reZ2B3BsyUwbkLIgXYrTosHJ6H_8G6tiwc04mwEz5HAUA0ErOYUSzUZ9lkyTS41cfjj1ILGYxb6VBm1oGPCWHbqhVtoYa5kwVPaGiykPrZRshAyYxIF6y_Q9CVg5doB2Pq5hm4UrFcuCUPwPLeq37fpklRezCfVXEXwjZhcb0g8PK8REBrgxY9-EXiwrUxL_efYGC5GlOdzXJvhFrPx7T4GXj8qZYSHXjerT4ztCq7l5YW7sFikrUBc0UImt0CUdUxAWR-iptSv6K9TjGoMleH961QVNcWWSCXThwzTW3IzDw5zMPEHMIUOtPxJjZPBlCcm-DCqnVAeHEVvQV02WPApHjgMyxO7_6HRYKEqbhhY6BVaCIepX3EaLfSVLOyOfRgs5BY0gIWb27aAhT30geRJGcUQ8DaqJwTc8e8CAJMlBPeTwLv6XQZ1Y3niHYv6qVaAtJr7MZxmQNTAAi5Zvh7eRyETD7ZMRwv9JQv7qWiQrRcXnwcLjRhp9ICgn2rlVhP0BLugZf_ZvSWCYyXw3u3fA7jw0ssALqe5RMBgU3Q2OtBih7FsUlYIjpPANbveBnD2uHEAXuDfCWDICpKSpF8AuHpHWwpmARaq3RMvgStYs6qA2ja8OfRHBLwjITG4tatbYwwpxT0Jbh6YtLokuJWw5DI1lDnTvsGCBwlD0mNYq_Vg4fq6T9FColveVYJEGMkeOLiTd1xGuI9VLFzLLlwcj-CnJTCWl8Eqz2AeNZlHTR_2CdO_KDsNLGAuWXYNTVtSlKTFoYUBkgX0gOAcNhkwvzkK4w8FRXCcw4wLmugZKFn4Jmm7lNm_oibiEvE6UWgA1z7zPOTJA5yTJErXWGcoVDdjy9SjafAyDJ2ECiy8h51SzQKFcTJbdxIwV9pxCbQmg23C8J5vOgB4n8gNzV9EfUws4K8smyWM96OyhWhhmWRhA2torBczWTLVLCpdhLe0sxZcMj4-fXmWu-SJI3xJdFbg4i1kBRssLDsrcyryVki8w5VbgZf3ygTgxUy7DTxYIkLKxkQmBI7MeUmeIDhPAtd_OcINjHliYt8m4ON7HoFKYR7QnR2vlMB1AxcBOJ2GXvTA0S-ugH5yNeI73lzTCcDkMAjOdyuQnLMvAbgDHRy5fvICEZoVq1dh0POsctsx7yncFXhwk-m7M-qyX1nslmPpjvCtdqu8gRFFYCEbJIJlxYOiqLFhX1Dogv8Fc4WG_ZGSZvMY3zGfd4SSXuMGtun4T8CjcJjmYKcL3ucKZ0b1FErgHeVDg68T3tfoPS_QU-gS4eF3hB7lZMVat-DdooEhvGFzD4nBE_bnY11a-33qROQVubX_2PfXAi-f3mm4DBMe6rFTDoIgrJN4_p3DpebMQw-BFiLuNCIn4sWcRx4WkIcQorlDA5obBgZQqA29cd81KVKgEOmZas6xOikXztMvE41EpbYCo4e09XUbvw2eodlob6rLojNBItgg6t--4B6Q82hchY6E5MDM60ELIbJz-CCaQLWbWCjFuyq_BLPpy9L5JKSESDvGUwnqyych6NLiiAUKGDSTh3JeMyVkRorStFvskLjYuDji8pEBl7cIbkvaTxd7gJn1uYPADMwUpDhIhkkjIrvAOf1OOexWdeXU9QS8iCXLKeoG4XKhnhx0NThrhLvsEQkMyivMReziwESZhBKuxASMbyy7S9YaSdmUWgnMLiv8Ep_cnJUftkJTW0rrkORINBvp8AJi2RgnS_-u42C0cNRtusXbgTDx8-sQU2cvt4BLll5C4yCWvHJMsoCONPTDN6ZIHQuUg_CwDzvjkHANr3OTpPX3TUGsZwcKPHijNv49JYKPu22UaYkz3bL00Hl6o0yL5fe1xGvYWwE8vNEZ3n8huUz13OCR0rQMXw5y5AmJx6WIl_NFejfmB08xWU6Zej3852GhCJAc4N1IOek2VfH0raERF244zMfMo0EbPSPxoDOIyYpvTJ0PwPhGjEeDIA-eOUp48puZ8-fOVv4D");
		// Patreon (__Travis__)
		registerPreset(9, "DMZF4:7Vl7cBXlFd-bhEcCRUBQoBbDy6LyyEsgFN27ewehxYlTjI_CYKHhFQ0GCeLuUiiOxg4dtCgQCCGAosUogoJSKUJyL8QiL41So1DEFgZbxlofI9J3v_udc77v25Pc-ndnrjMOO3dzfuf7zvN3zuZYVo4VcbPF_zmWZXXtYGWUefFNm06KhwWe89ilw-Khyrcn9ZevAmf7s79PvgqcZVUzMq1IuRCaKf6tEP9mWFLaqb79dpD-ZOOvQHriVe9L6aYhbj8uPSssHb-j99PtS_vxazPrJEzcXrFJwsTF-RBmNoM548-UMG6PKYNNmAV-_EzfG-Euhz6bDjDiF4SZw-4CKhWMOATeznfqlhYAzIV95yVM075JryHMXAaz_Ir34FItq34XNkl82rotcIiD3SpQupxJnx17LoVJojPgWPouzsg3bkWYexhMhZQWd8k8sVcKudaWB0B3Q2YdCt3LhJpHfAS6xfGkUPRPp4eAplmnvkChCmb8kiefCmuKrwPjB1Fto3lhIcL13Jy18-FOJ4r-CMfrtXcpCt3HNG0deAqE-p95DIRW1rZye1YqIRHnk5Nx3gGkt8yYIqWTngPD3gl4fmJC5RuAN-GyzYAnXAd4kWHMRpgTXhxsJGBKB2wFmPmWBQao-_BHAPP3wd0QZrgJU-XZ4_rkSLzEyJpxgNcgo0_gPZFbJf29f_70ayCIhUmSrwLb7Xe_1JAgZx4YMHclahjJDvr8uangTJF-Zl6LgypPrXj_Tjjo7uVZCJMXhklkzfwKYCCTDBg0pIA5_89ZAKOiJJJvuqE06Ybu4AaMXSO-fyjvK5KsAVM-Wt_YV-LZd92xHPFWfmPlIJjEMHliIw4dfbsnmBtKro7CNYde_j2Jl5j667MMb-vkT8H6s4eeBmCsN0FiVU4LAj_JgMuv6wHAE2VQiKCFYylggWdTbVJlQYfdKnbfAcvWw32hEikYUaQekmVGHAvzwyi4kdUMBk3iOSraIAmE9KxvPwvSP2jJRek1LKT2XLhbSjcKvzAjqdhfCNkQNA2MfowwNewQu6UdzXJNh3AuZsxhxT6ylknvnDMNpPvIu2hLBHGsX4Gjpdel0K3DGdJXFEj0VBDX5qtlydDvL39jJyfdztsyy0I5sJ5Jjz25H6SHPO2EdauK0fTljCkoXcdOTsZ3y2-8JWx8t6bieoDZ98KHcAjtww3sEFg5DPOpQyx-5jmQVm0lUs-ke8uUV8XecJ3b4xejeRBvZNKUC46qnVSC45DGwo6UtLpPRzYpGPGwKPkgasrNyZqSBcm2tGBxWMGBrBd7goLxMqqNZCO-Q7f8n0l7IFtWIoHzcF0XeVAK_cCeNsQFQCy0huetCANGE3uJK4d5UGb-M-oKAH50w03haq81TL9mEdik9WIZ6ydWBtOA1_MSo-WD0HCJyn6x5CMCD2xh4CVKChYjXqbC62xlzCmzOg3Kk_8JS99CTVSowQZktC1Vj9ZCIPg30UVsdRGyvdvl44tScWyQImGHWI1BHmAkKHG5RB-kUe1xhcMsWxSM6g9Q6gVM4XcboIlmPHID5ylHGAzSPS_ZQsLdTzEXKimBowLfOs4uRRwbhczTKBhkbEb9td4ynBK5z-oYe6BqYeW8JIm_LU3i0yQ-TeLTJD5N4tMkPk3i0yQ-TeLTJD5N4v-_SHwpkfju0i_R3n8dBsQKW6cX6_7Qcakp2lPWrDK_sWZcn7Bf6FWQdBnj91kQV9HO5QfhCj2DtQDcGXM3mi2zRfAAUekBr8PclaxvK8ZPeB2hh3qOInPnrh8PeB3_fB3AwMOCoFHDzGYwl33SDDDYbrxYx2mNANNj3o8BphtWxaZYydWM8RNMz-HbAIZIbKzPVyNNGMG6D7fkhlkYKQ-avj47lAfQXKYhW1ZtEUk5X9dAwiCMH-3U8CDY7-dQCwI0tmB1RZbFxgPCw2MZF6dSh_c1_UEWsNH1QVSoYgNDG8cQRXA_evMCOka-Uo4Bi3JH38vwutxzKTwOxXrKKi3wcp5_AfDAAoLw7T3Sn3u8guF1lWEiIvxns68FvAzJOpOBCJ3RT-yVRVoZUiRV5sI1UOlEw2ajCAHjIYwY6I1zG15cuB5H43YsEFU0R40rBAzZIIBxgjVyMuu5mAwuu2jid6SGqPJZJlYnBwPGbCuVTENkK5BqB7mboSEDWJKfrCYAbJ0_AEf_oHUQo8XW_FRZj4TCSC-yiWpT9IsZXPczPLyvR73BixXcehvgwbFEk_j30cmqGDEGaS1I5TMaA2IjZCkTeGh1v_Gd0oFgWpVeeIqAPG2uFKqUBhobvwUd77dSusxrRFd57j-I-uArkcnyQfSELZ-vhssclO1HqCJGlii-cDebKPEydrxwe9iLbu2xatDQZEXgMhQnSdICGvbmTwANuLUweddwpuG1vMtBA87Lnvv5Sy-Chj3yQQ1fAvglWU8EcN9_1bKFQWQEA35VEm5R3ShO3FKsn_ZOKK2a1ySLGmjAV8aGSI3vaoolDfuR2ukWegE9jRYw6qe9e4cfHiCNATyPAb_-8h8AGKm3526XsSSAQadpbDRgQJcxCXY-A25-9afh1Zi7KPEKAENUiJDEFURgN-7qJYHJweb4UMCAd1KzUhPQCikkgHcVFjHKtQOIpjlIFaayAI6fupVQcPlRLHN-_DNyHgSMuSsRDAs1FKWKO5q6YhHavVDcabZLNrYxcYMktUTgGxgwppdHmedF1VIHLeo3YZ_wE0uqy0EDxpKeExOixaGGUUwDWsAwDjEDspuuMLhPMYxDyo2aGBnDNLxd_DKL7E-xJuIrYXVknYF9ePT3IU7aMU6xWbpKNSm0t2HLdHJp7lJk-GHslPYyqDA6svWmT-1c6MRboDV5dAjPPdlpFOA9wxtaol7aWGhAqSBOAeP-suFBto4hDU9RQ6NerPcUy2TpEniPw8pGp4xexaotDI8TXfiKJVdQxduICiIW5vy_iuEd2r0D8FZPvYttdeCVKKRqWYeFQJe55NDM9jIE3PKbSamAMU587NsC-PieKyFTyALGwmcNAz42ZglbCCsLHJGbLrXHM0-8rfkqAFYDllritEkQ3CEaCwW0KCWI0awoXw2ip_Y7bU6seooyBV7cp_quqS5JBTTltLcDapN5Y7LrQUM1lAiKiva8GCWyb1To2m8EVhUazidSmviYOrHiO0ZKr08FHJf0XwCXIJlWwLoLtjGF5qhqqUTAu7bfHB4n3J_IOS_ZU-QrgYd_Y_QoHRUbUjnvC-kYgQe7deU843xN1KWjeulVn6r95z26AfBg16XKsMDDeqzTwSgIGxle4pWJrDkr14OjDY_rRqQ9vknhpVhFYaH26EOR4SmoEBVV9oqjx1gsnJR_LGpkLu0g9XKKjj5lcDfgWqcgb70DNKfoDxnV1OoKe1WyVV6bnZQyhaKdsBgReFtxMtUfHpBrmcuJDHY-vINRaxXvgZ5sEiqodyEGnqnw1AZqfH5efj5toLqGm5D-hLR55VhQAwxCpMKX8lOPSQhpXDO-Yx1KlWP0hcddQqFxQprBGCXsd-VXOiNGjMn1TQYMddZgQTQmUAkWtR0GYAGMvwS08DfqmNpxETCNJmpkj3WhZMPG50cfl1knQiOXCByOG0GcPp45-ovokVRcFmcBg9-r4Ydqsas04KvAwU9uRoJbR5kGNKRH3zSN_gR1QuBh19Xkxxi6j6UqQJvbcB7q0Ml0Dh9UfTkxgI-nOihVDs1lKTwcFd5YlM30e4vhtb6-k311VivhD-SC3-TG8MchQ77D8FThUel8Wk7C6uJlPsWUT1-mAywCIgZU77HeTcWhVPg201Kc5hmyMVk0dND3GB70ATNY8RffUXQXfzH90WqUB2MXav0X");
    }

    private static final String BASE64_URL_ALPHABET = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";

    private static byte[] compressOptimized(byte[] data) throws Exception {
        ByteArrayOutputStream byteOut = new ByteArrayOutputStream();
        Deflater deflater = new Deflater(Deflater.BEST_COMPRESSION, true);
        DeflaterOutputStream defOut = new DeflaterOutputStream(byteOut, deflater);
        defOut.write(data);
        defOut.close();
        deflater.end();
        return byteOut.toByteArray();
    }

    private static byte[] decompressOptimized(byte[] data) throws Exception {
        ByteArrayInputStream byteIn = new ByteArrayInputStream(data);
        Inflater inflater = new Inflater(true);
        InflaterInputStream infIn = new InflaterInputStream(byteIn, inflater);
        ByteArrayOutputStream byteOut = new ByteArrayOutputStream();
        byte[] buffer = new byte[1024];
        int len;
        while ((len = infIn.read(buffer)) != -1) byteOut.write(buffer, 0, len);
        infIn.close();
        inflater.end();
        return byteOut.toByteArray();
    }

    private static String encodeToNumbers(byte[] bytes) {
        if (bytes == null || bytes.length == 0) return "";
        BigInteger value = new BigInteger(1, bytes);
        if (value.equals(BigInteger.ZERO)) return String.valueOf(BASE64_URL_ALPHABET.charAt(0));

        StringBuilder result = new StringBuilder();
        BigInteger base = BigInteger.valueOf(64);

        while (value.compareTo(BigInteger.ZERO) > 0) {
            BigInteger[] divmod = value.divideAndRemainder(base);
            result.append(BASE64_URL_ALPHABET.charAt(divmod[1].intValue()));
            value = divmod[0];
        }

        return result.reverse().toString();
    }

    private static byte[] decodeFromNumbers(String encoded) {
        return decodeBase64Url(encoded);
    }

    private static byte[] decodeBase64Url(String encoded) {
        if (encoded == null || encoded.isEmpty()) return new byte[0];
        BigInteger value = BigInteger.ZERO;
        BigInteger base = BigInteger.valueOf(64);

        for (int i = 0; i < encoded.length(); i++) {
            char c = encoded.charAt(i);
            int digit = BASE64_URL_ALPHABET.indexOf(c);
            if (digit < 0) throw new IllegalArgumentException("Invalid character in Base64URL string: " + c);
            value = value.multiply(base).add(BigInteger.valueOf(digit));
        }

        byte[] bytes = value.toByteArray();
        if (bytes.length > 1 && bytes[0] == 0) {
            byte[] result = new byte[bytes.length - 1];
            System.arraycopy(bytes, 1, result, 0, result.length);
            return result;
        }
        return bytes;
    }

    private static final String BASE62_ALPHABET = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";

    private static byte[] decodeBase62(String encoded) {
        if (encoded == null || encoded.isEmpty()) return new byte[0];
        BigInteger value = BigInteger.ZERO;
        BigInteger base = BigInteger.valueOf(62);

        for (int i = 0; i < encoded.length(); i++) {
            char c = encoded.charAt(i);
            int digit = BASE62_ALPHABET.indexOf(c);
            if (digit < 0) throw new IllegalArgumentException("Invalid character in Base62 string: " + c);
            value = value.multiply(base).add(BigInteger.valueOf(digit));
        }

        byte[] bytes = value.toByteArray();
        if (bytes.length > 1 && bytes[0] == 0) {
            byte[] result = new byte[bytes.length - 1];
            System.arraycopy(bytes, 1, result, 0, result.length);
            return result;
        }

        return bytes;
    }

    public static String toCode(CustomHair hair) {
		if (hair == null) return "";
		try {
			CompoundTag tag = hair.save();
			ByteArrayOutputStream nbtOut = new ByteArrayOutputStream();
			DataOutputStream dataOut = new DataOutputStream(nbtOut);
			NbtIo.write(tag, dataOut);
			dataOut.close();
			byte[] nbtBytes = nbtOut.toByteArray();

			byte[] compressed = compressOptimized(nbtBytes);

			return CODE_PREFIX_V5 + encodeToNumbers(compressed);
		} catch (Exception e) {
			LogUtil.error(Env.CLIENT, "Failed to serialize CustomHair to code", e);
			return "";
		}
	}

	public static CustomHair fromCode(String code) {
		if (code == null || code.isEmpty()) return null;

		if (isFullSetCode(code)) {
			CustomHair[] set = fromFullSetCode(code);
			return (set != null && set.length > 0) ? set[0] : null;
		}

		try {
			String cleanCode = code;
			boolean isV5 = code.startsWith(CODE_PREFIX_V5);
			boolean isV4 = code.startsWith(CODE_PREFIX_V4);

			if (isV5) cleanCode = code.substring(CODE_PREFIX_V5.length());
			else if (isV4) cleanCode = code.substring(CODE_PREFIX_V4.length());

			byte[] bytes = decodeFromNumbers(cleanCode);
			CompoundTag tag;

			if (isV4) {
				byte[] decompressed = decompressOptimized(bytes);
				ByteArrayInputStream byteIn = new ByteArrayInputStream(decompressed);
				DataInputStream dataIn = new DataInputStream(byteIn);
				tag = NbtIo.read(dataIn);
			} else {
				ByteArrayInputStream byteIn = new ByteArrayInputStream(bytes);
				GZIPInputStream gzipIn = new GZIPInputStream(byteIn);
				DataInputStream dataIn = new DataInputStream(gzipIn);
				tag = NbtIo.read(dataIn);
			}

			if (tag.contains("Base") && (tag.contains("SSJ") || tag.contains("SSJ2") || tag.contains("SSJ3"))) {
				CustomHair base = new CustomHair();
				if (tag.contains("Base")) base.load(tag.getCompound("Base"));
				return base;
			}

			CustomHair hair = new CustomHair();
			hair.load(tag);
			return hair;
		} catch (Exception e) {
			LogUtil.error(Env.CLIENT, "Failed to deserialize CustomHair from code", e);
			return null;
		}
	}

	public static String toFullSetCode(CustomHair base, CustomHair ssj, CustomHair ssj2, CustomHair ssj3) {
		if (base == null) base = new CustomHair();
		if (ssj == null) ssj = base.copy();
		if (ssj2 == null) ssj2 = ssj.copy();
		if (ssj3 == null) ssj3 = base.copy();

		try {
			CompoundTag fullSetTag = new CompoundTag();
			fullSetTag.put("B", base.save());
			fullSetTag.put("S", ssj.save());
			fullSetTag.put("S2", ssj2.save());
			fullSetTag.put("T", ssj3.save());

			ByteArrayOutputStream nbtOut = new ByteArrayOutputStream();
			DataOutputStream dataOut = new DataOutputStream(nbtOut);
			NbtIo.write(fullSetTag, dataOut);
			dataOut.close();
			byte[] nbtBytes = nbtOut.toByteArray();

			byte[] compressed = compressOptimized(nbtBytes);

			return CODE_PREFIX_FULL_V4 + encodeToNumbers(compressed);
		} catch (Exception e) {
			LogUtil.error(Env.CLIENT, "Failed to serialize CustomHair full set to code", e);
			return "";
		}
	}

	public static CustomHair[] fromFullSetCode(String code) {
		if (code == null) return null;

		boolean isV5 = code.startsWith(CODE_PREFIX_FULL_V5);
		boolean isV4 = code.startsWith(CODE_PREFIX_FULL_V4);

		if (!isV5 && !isV4) return null;

		try {
			String cleanCode = isV5 ?
				code.substring(CODE_PREFIX_FULL_V5.length()) :
				code.substring(CODE_PREFIX_FULL_V4.length());

			byte[] bytes = decodeFromNumbers(cleanCode);
			CompoundTag fullSetTag;

			byte[] decompressed = decompressOptimized(bytes);
			ByteArrayInputStream byteIn = new ByteArrayInputStream(decompressed);
			DataInputStream dataIn = new DataInputStream(byteIn);
			fullSetTag = NbtIo.read(dataIn);


			CustomHair base = null, ssj = null, ssj2 = null, ssj3 = null;

			if (fullSetTag.contains("B") || fullSetTag.contains("Base")) {
				base = new CustomHair();
				base.load(fullSetTag.contains("B") ? fullSetTag.getCompound("B") : fullSetTag.getCompound("Base"));
			}
			if (fullSetTag.contains("S") || fullSetTag.contains("SSJ")) {
				ssj = new CustomHair();
				ssj.load(fullSetTag.contains("S") ? fullSetTag.getCompound("S") : fullSetTag.getCompound("SSJ"));
			}
			if (fullSetTag.contains("S2") || fullSetTag.contains("SSJ2")) {
				ssj2 = new CustomHair();
				ssj2.load(fullSetTag.contains("S2") ? fullSetTag.getCompound("S2") : fullSetTag.getCompound("SSJ2"));
			}
			if (fullSetTag.contains("T") || fullSetTag.contains("SSJ3")) {
				ssj3 = new CustomHair();
				ssj3.load(fullSetTag.contains("T") ? fullSetTag.getCompound("T") : fullSetTag.getCompound("SSJ3"));
			}

			if (ssj2 == null && ssj != null) ssj2 = ssj.copy();

			if (base == null) base = new CustomHair();
			if (ssj == null) ssj = base.copy();
			if (ssj2 == null) ssj2 = base.copy();
			if (ssj3 == null) ssj3 = base.copy();

			return new CustomHair[]{base, ssj, ssj2, ssj3};

		} catch (Exception e) {
			LogUtil.error(Env.CLIENT, "Failed to deserialize full set code, trying fallback format", e);
			return fromFullSetCodeFallback(code);
		}
	}

	private static CustomHair[] fromFullSetCodeFallback(String code) {
		if (code == null || !code.startsWith(CODE_PREFIX_FULL_V4)) return null;

		String rawData = code.substring(CODE_PREFIX_FULL_V4.length());
		String[] parts = rawData.split(FULL_SET_SEPARATOR);

		if (parts.length < 3) return null;

		CustomHair base = fromCode(parts[0]);
		CustomHair ssj = fromCode(parts[1]);
		CustomHair ssj3 = fromCode(parts[2]);

		CustomHair ssj2 = ssj != null ? ssj.copy() : new CustomHair();

		if (base == null || ssj == null || ssj3 == null) return null;

		return new CustomHair[]{base, ssj, ssj2, ssj3};
	}

	public static boolean isFullSetCode(String code) {
		return code != null && (code.startsWith(CODE_PREFIX_FULL_V5) || code.startsWith(CODE_PREFIX_FULL_V4));
	}

    public static boolean canUseHair(Character character) {
        if (character == null) return false;
        String race = character.getRace().toLowerCase();
        String gender = character.getGender().toLowerCase();

        for (String defaultRace : DEFAULT_HAIR_RACES) if (race.equals(defaultRace)) return true;

        if (race.equals("majin")) return gender.equals(Character.GENDER_FEMALE);
        if (race.equals("bioandroid") || race.equals("frostdemon") || race.equals("namekian")) return false;

        RaceCharacterConfig config = ConfigManager.getRaceCharacter(race);
        return config != null && config.canUseHair();
    }

    public static CustomHair getEffectiveHair(Character character) {
        if (!canUseHair(character)) return null;
        int hairId = character.getHairId();
        if (hairId == 0) {
            CustomHair custom = character.getHairBase();
            if (custom == null) {
                custom = new CustomHair();
                character.setHairBase(custom);
            }
            return custom;
        }

        return getPresetHair(hairId, character.getHairColor());
    }

    public static CustomHair getPresetHair(int presetId, String hairColor) {
        return getPresetHairByType(presetId, hairColor, 0);
	}

	public static CustomHair getPresetHairSSJ(int presetId, String hairColor) {
		return getPresetHairByType(presetId, hairColor, 1);
	}

	public static CustomHair getPresetHairSSJ2(int presetId, String hairColor) {
		return getPresetHairByType(presetId, hairColor, 2);
	}

	public static CustomHair getPresetHairSSJ3(int presetId, String hairColor) {
		return getPresetHairByType(presetId, hairColor, 3);
	}

	public static boolean isPresetFullSet(int presetId) {
		String code = PRESET_CODES.get(presetId);
		return code != null && isFullSetCode(code);
	}

	private static CustomHair getPresetHairByType(int presetId, String hairColor, int type) {
		String code = PRESET_CODES.get(presetId);
		if (code == null) return new CustomHair();

		if (isFullSetCode(code)) {
			if (!PRESET_FULL_CACHE.containsKey(presetId)) {
				CustomHair[] fullSet = fromFullSetCode(code);
				if (fullSet != null && fullSet.length >= 3) PRESET_FULL_CACHE.put(presetId, fullSet);
				else return new CustomHair();
			}

			CustomHair[] cached = PRESET_FULL_CACHE.get(presetId);
			if (cached != null && type >= 0 && type < cached.length && cached[type] != null) {
				CustomHair hair = cached[type].copy();
				if (hairColor != null && !hairColor.isEmpty()) hair.setGlobalColor(hairColor);
				return hair;
			}
			return new CustomHair();
		}

		if (!PRESET_CACHE.containsKey(presetId)) {
			CustomHair baseHair = fromCode(code);
			if (baseHair != null) PRESET_CACHE.put(presetId, baseHair);
			else return new CustomHair();
		}

		CustomHair hair = PRESET_CACHE.get(presetId).copy();
		if (hair != null) {
			if (hairColor != null && !hairColor.isEmpty()) hair.setGlobalColor(hairColor);
			return hair;
		}

		CustomHair basic = new CustomHair();
		if (hairColor != null && !hairColor.isEmpty()) basic.setGlobalColor(hairColor);
		return basic;
	}

    public static void registerPreset(int presetId, String code) {
        if (presetId > 0 && code != null && !code.isEmpty()) PRESET_CODES.put(presetId, code);
    }

    public static int getPresetCount() {
        return PRESET_CODES.size();
    }
}
